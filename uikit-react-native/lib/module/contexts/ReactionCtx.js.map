{"version":3,"names":["React","useCallback","useContext","useReducer","useRef","useState","NOOP","ReactionBottomSheets","LocalizationContext","SendbirdChatContext","UserProfileContext","ReactionContext","createContext","ReactionProvider","_ref","children","chatCtx","localizationCtx","userProfileCtx","Error","state","setState","prev","next","reactionListVisible","setReactionListVisible","reactionUserListVisible","setReactionUserListVisible","reactionUserListFocusIndex","setReactionUserListFocusIndex","closeResolver","openReactionList","params","openReactionUserList","_ref2","channel","message","focusIndex","updateReactionFocusedItem","createOnCloseWithResolver","callback","Promise","resolve","current","reactionCtx","sheetProps","onDismiss","_closeResolver$curren","call","createElement","Provider","value","UserList","_extends","visible","onClose","ReactionList"],"sources":["ReactionCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useReducer, useRef, useState } from 'react';\n\nimport type { SendbirdBaseChannel, SendbirdBaseMessage } from '@sendbird/uikit-utils';\nimport { NOOP } from '@sendbird/uikit-utils';\n\nimport { ReactionBottomSheets } from '../components/ReactionBottomSheets';\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\nimport { UserProfileContext } from '../contexts/UserProfileCtx';\n\ntype State = {\n  message?: SendbirdBaseMessage;\n  channel?: SendbirdBaseChannel;\n};\nexport type ReactionContextType = {\n  openReactionList(param: Required<State>): void;\n  openReactionUserList(param: Required<State> & { focusIndex?: number }): void;\n  updateReactionFocusedItem(param?: State): void;\n  focusIndex: number;\n} & State;\n\ntype Props = React.PropsWithChildren<{}>;\n\nexport const ReactionContext = React.createContext<ReactionContextType | null>(null);\nexport const ReactionProvider = ({ children }: Props) => {\n  const chatCtx = useContext(SendbirdChatContext);\n  const localizationCtx = useContext(LocalizationContext);\n  const userProfileCtx = useContext(UserProfileContext);\n  if (!chatCtx) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationCtx) throw new Error('LocalizationContext is not provided');\n  if (!userProfileCtx) throw new Error('UserProfileContext is not provided');\n\n  const [state, setState] = useReducer((prev: State, next: State) => ({ ...prev, ...next }), {});\n  const [reactionListVisible, setReactionListVisible] = useState(false);\n  const [reactionUserListVisible, setReactionUserListVisible] = useState(false);\n  const [reactionUserListFocusIndex, setReactionUserListFocusIndex] = useState(0);\n\n  const closeResolver = useRef<() => void>(NOOP);\n\n  const openReactionList: ReactionContextType['openReactionList'] = useCallback((params) => {\n    setState(params);\n    setReactionListVisible(true);\n  }, []);\n\n  const openReactionUserList: ReactionContextType['openReactionUserList'] = useCallback(\n    ({ channel, message, focusIndex = 0 }) => {\n      setState({ channel, message });\n      setReactionUserListFocusIndex(focusIndex);\n      setReactionUserListVisible(true);\n    },\n    [],\n  );\n\n  const updateReactionFocusedItem: ReactionContextType['updateReactionFocusedItem'] = useCallback((params) => {\n    if (params) setState(params);\n    else setState({});\n  }, []);\n\n  const createOnCloseWithResolver = (callback: () => void) => {\n    return () => {\n      return new Promise<void>((resolve) => {\n        closeResolver.current = resolve;\n        callback();\n      });\n    };\n  };\n\n  const reactionCtx = {\n    ...state,\n    openReactionList,\n    openReactionUserList,\n    updateReactionFocusedItem,\n    focusIndex: reactionUserListFocusIndex,\n  };\n\n  const sheetProps = {\n    chatCtx,\n    reactionCtx,\n    localizationCtx,\n    userProfileCtx,\n    onDismiss: () => {\n      setState({});\n      closeResolver.current?.();\n    },\n  };\n\n  return (\n    <ReactionContext.Provider value={reactionCtx}>\n      {children}\n      <ReactionBottomSheets.UserList\n        {...sheetProps}\n        visible={reactionUserListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionUserListVisible(false))}\n      />\n      <ReactionBottomSheets.ReactionList\n        {...sheetProps}\n        visible={reactionListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionListVisible(false))}\n      />\n    </ReactionContext.Provider>\n  );\n};\n"],"mappings":"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"}