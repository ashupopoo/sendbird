{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","Animated","Easing","useGroupChannelMessages","NOOP","PASS","messageComparator","useFreshCallback","useRefTracker","MessageRenderer","NewMessagesButton","ScrollToBottomButton","StatusComposition","MESSAGE_FOCUS_ANIMATION_DELAY","MESSAGE_SEARCH_SAFE_SCROLL_DELAY","createGroupChannelModule","useSendbirdChat","pubsub","createGroupChannelFragment","initModule","GroupChannelModule","_ref","searchItem","renderNewMessagesButton","props","createElement","renderScrollToBottomButton","renderMessage","enableMessageGrouping","enableTypingIndicator","onPressHeaderLeft","onPressHeaderRight","onPressMediaMessage","onChannelDeleted","onBeforeSendUserMessage","onBeforeSendFileMessage","onBeforeUpdateUserMessage","onBeforeUpdateFileMessage","channel","keyboardAvoidOffset","queryCreator","collectionCreator","sortComparator","flatListProps","onPressImageMessage","sdk","currentUser","internalSearchItem","setInternalSearchItem","navigateFromMessageSearch","Boolean","groupChannelPubSub","scrolledAwayFromBottom","setScrolledAwayFromBottom","scrolledAwayFromBottomRef","loading","messages","newMessages","resetNewMessages","next","prev","hasNext","sendFileMessage","sendUserMessage","updateFileMessage","updateUserMessage","resendMessage","deleteMessage","resetWithStartingPoint","userId","enableCollectionWithoutLocalCache","shouldCountNewMessages","current","onMessagesReceived","publish","type","data","startingPoint","MessageComponent","withFocusingAnimation","Fragment","_renderMessage","memoizedFlatListProps","ListEmptyComponent","StatusEmpty","contentContainerStyle","flexGrow","onResetMessageList","callback","Number","MAX_SAFE_INTEGER","undefined","onPending","message","onSent","onPressSendUserMessage","params","processedParams","onPressSendFileMessage","onPressUpdateUserMessage","messageId","onPressUpdateFileMessage","onScrolledAwayFromBottom","value","onSendFileMessage","file","onSendUserMessage","text","mention","mentionedUserIds","userIds","mentionedMessageTemplate","messageTemplate","mentionType","onUpdateFileMessage","editedFile","onUpdateUserMessage","editedText","Provider","Header","shouldHideRight","LoadingComponent","StatusLoading","MessageList","currentUserId","onTopReached","onBottomReached","onResendFailedMessage","onDeleteMessage","nextMessages","newMessagesFromMembers","Input","SuggestedMentionList","shouldRenderInput","isBroadcast","myRole","Component","memo","translateY","Value","focused","setTimeout","sequence","toValue","duration","map","timing","useNativeDriver","easing","inOut","ease","start","View","style","transform"],"sources":["createGroupChannelFragment.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Animated, Easing } from 'react-native';\n\nimport { useGroupChannelMessages } from '@sendbird/uikit-chat-hooks';\nimport {\n  NOOP,\n  PASS,\n  SendbirdFileMessage,\n  SendbirdGroupChannel,\n  SendbirdUserMessage,\n  messageComparator,\n  useFreshCallback,\n  useRefTracker,\n} from '@sendbird/uikit-utils';\n\nimport MessageRenderer from '../components/MessageRenderer';\nimport NewMessagesButton from '../components/NewMessagesButton';\nimport ScrollToBottomButton from '../components/ScrollToBottomButton';\nimport StatusComposition from '../components/StatusComposition';\nimport { MESSAGE_FOCUS_ANIMATION_DELAY, MESSAGE_SEARCH_SAFE_SCROLL_DELAY } from '../constants';\nimport createGroupChannelModule from '../domain/groupChannel/module/createGroupChannelModule';\nimport type {\n  GroupChannelFragment,\n  GroupChannelModule,\n  GroupChannelProps,\n  GroupChannelPubSubContextPayload,\n} from '../domain/groupChannel/types';\nimport { useSendbirdChat } from '../hooks/useContext';\nimport pubsub from '../utils/pubsub';\n\nconst createGroupChannelFragment = (initModule?: Partial<GroupChannelModule>): GroupChannelFragment => {\n  const GroupChannelModule = createGroupChannelModule(initModule);\n\n  return ({\n    searchItem,\n    renderNewMessagesButton = (props) => <NewMessagesButton {...props} />,\n    renderScrollToBottomButton = (props) => <ScrollToBottomButton {...props} />,\n    renderMessage,\n    enableMessageGrouping = true,\n    enableTypingIndicator = true,\n    onPressHeaderLeft = NOOP,\n    onPressHeaderRight = NOOP,\n    onPressMediaMessage = NOOP,\n    onChannelDeleted = NOOP,\n    onBeforeSendUserMessage = PASS,\n    onBeforeSendFileMessage = PASS,\n    onBeforeUpdateUserMessage = PASS,\n    onBeforeUpdateFileMessage = PASS,\n    channel,\n    keyboardAvoidOffset,\n    queryCreator,\n    collectionCreator,\n    sortComparator = messageComparator,\n    flatListProps,\n    onPressImageMessage,\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n\n    const [internalSearchItem, setInternalSearchItem] = useState(searchItem);\n    const navigateFromMessageSearch = useCallback(() => Boolean(searchItem), []);\n\n    const [groupChannelPubSub] = useState(() => pubsub<GroupChannelPubSubContextPayload>());\n    const [scrolledAwayFromBottom, setScrolledAwayFromBottom] = useState(false);\n    const scrolledAwayFromBottomRef = useRefTracker(scrolledAwayFromBottom);\n\n    const {\n      loading,\n      messages,\n      newMessages,\n      resetNewMessages,\n      next,\n      prev,\n      hasNext,\n      sendFileMessage,\n      sendUserMessage,\n      updateFileMessage,\n      updateUserMessage,\n      resendMessage,\n      deleteMessage,\n      resetWithStartingPoint,\n    } = useGroupChannelMessages(sdk, channel, currentUser?.userId, {\n      collectionCreator,\n      queryCreator,\n      sortComparator,\n      onChannelDeleted,\n      enableCollectionWithoutLocalCache: !queryCreator,\n      shouldCountNewMessages: () => scrolledAwayFromBottomRef.current,\n      onMessagesReceived(messages) {\n        groupChannelPubSub.publish({ type: 'MESSAGES_RECEIVED', data: { messages } });\n      },\n      startingPoint: internalSearchItem?.startingPoint,\n    });\n\n    const MessageComponent: GroupChannelProps['MessageList']['renderMessage'] = useCallback(\n      withFocusingAnimation(renderMessage ? (props) => <>{renderMessage(props)}</> : MessageRenderer),\n      [renderMessage],\n    );\n\n    const _renderMessage: GroupChannelProps['MessageList']['renderMessage'] = useFreshCallback((props) => {\n      return <MessageComponent {...props} />;\n    });\n\n    const memoizedFlatListProps = useMemo(\n      () => ({\n        ListEmptyComponent: <GroupChannelModule.StatusEmpty />,\n        contentContainerStyle: { flexGrow: 1 },\n        ...flatListProps,\n      }),\n      [flatListProps],\n    );\n\n    const onResetMessageList = useCallback((callback?: () => void) => {\n      resetWithStartingPoint(Number.MAX_SAFE_INTEGER, callback);\n      setInternalSearchItem(undefined);\n    }, []);\n\n    const onPending = (message: SendbirdFileMessage | SendbirdUserMessage) => {\n      groupChannelPubSub.publish({ type: 'MESSAGE_SENT_PENDING', data: { message } });\n    };\n\n    const onSent = (message: SendbirdFileMessage | SendbirdUserMessage) => {\n      groupChannelPubSub.publish({ type: 'MESSAGE_SENT_SUCCESS', data: { message } });\n    };\n\n    const onPressSendUserMessage: GroupChannelProps['Input']['onPressSendUserMessage'] = useFreshCallback(\n      async (params) => {\n        const processedParams = await onBeforeSendUserMessage(params);\n        const message = await sendUserMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    const onPressSendFileMessage: GroupChannelProps['Input']['onPressSendFileMessage'] = useFreshCallback(\n      async (params) => {\n        const processedParams = await onBeforeSendFileMessage(params);\n        const message = await sendFileMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    const onPressUpdateUserMessage: GroupChannelProps['Input']['onPressUpdateUserMessage'] = useFreshCallback(\n      async (message, params) => {\n        const processedParams = await onBeforeUpdateUserMessage(params);\n        await updateUserMessage(message.messageId, processedParams);\n      },\n    );\n    const onPressUpdateFileMessage: GroupChannelProps['Input']['onPressUpdateFileMessage'] = useFreshCallback(\n      async (message, params) => {\n        const processedParams = await onBeforeUpdateFileMessage(params);\n        await updateFileMessage(message.messageId, processedParams);\n      },\n    );\n    const onScrolledAwayFromBottom = useFreshCallback((value: boolean) => {\n      if (!value) resetNewMessages();\n      setScrolledAwayFromBottom(value);\n    });\n\n    /** @deprecated **/\n    const onSendFileMessage: GroupChannelProps['Input']['onSendFileMessage'] = useFreshCallback(async (file) => {\n      const processedParams = await onBeforeSendFileMessage({ file });\n      const message = await sendFileMessage(processedParams, onPending);\n      onSent(message);\n    });\n    /** @deprecated **/\n    const onSendUserMessage: GroupChannelProps['Input']['onSendUserMessage'] = useFreshCallback(\n      async (text, mention) => {\n        const processedParams = await onBeforeSendUserMessage({\n          message: text,\n          mentionedUserIds: mention?.userIds,\n          mentionedMessageTemplate: mention?.messageTemplate,\n          mentionType: mention?.type,\n        });\n        const message = await sendUserMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    /** @deprecated **/\n    const onUpdateFileMessage: GroupChannelProps['Input']['onUpdateFileMessage'] = useFreshCallback(\n      async (editedFile, message) => {\n        const processedParams = await onBeforeSendFileMessage({ file: editedFile });\n        await updateFileMessage(message.messageId, processedParams);\n      },\n    );\n    /** @deprecated **/\n    const onUpdateUserMessage: GroupChannelProps['Input']['onUpdateUserMessage'] = useFreshCallback(\n      async (editedText, message, mention) => {\n        const processedParams = await onBeforeSendUserMessage({\n          message: editedText,\n          mentionedUserIds: mention?.userIds,\n          mentionedMessageTemplate: mention?.messageTemplate,\n          mentionType: mention?.type,\n        });\n        await updateUserMessage(message.messageId, processedParams);\n      },\n    );\n\n    return (\n      <GroupChannelModule.Provider\n        channel={channel}\n        groupChannelPubSub={groupChannelPubSub}\n        enableTypingIndicator={enableTypingIndicator}\n        keyboardAvoidOffset={keyboardAvoidOffset}\n      >\n        <GroupChannelModule.Header\n          shouldHideRight={navigateFromMessageSearch}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={onPressHeaderRight}\n        />\n        <StatusComposition loading={loading} LoadingComponent={<GroupChannelModule.StatusLoading />}>\n          <GroupChannelModule.MessageList\n            channel={channel}\n            searchItem={internalSearchItem}\n            onResetMessageList={onResetMessageList}\n            enableMessageGrouping={enableMessageGrouping}\n            currentUserId={currentUser?.userId}\n            renderMessage={_renderMessage}\n            messages={messages}\n            newMessages={newMessages}\n            onTopReached={prev}\n            onBottomReached={next}\n            hasNext={hasNext}\n            scrolledAwayFromBottom={scrolledAwayFromBottom}\n            onScrolledAwayFromBottom={onScrolledAwayFromBottom}\n            renderNewMessagesButton={renderNewMessagesButton}\n            renderScrollToBottomButton={renderScrollToBottomButton}\n            onResendFailedMessage={resendMessage}\n            onDeleteMessage={deleteMessage}\n            onPressMediaMessage={onPressMediaMessage}\n            flatListProps={memoizedFlatListProps}\n            nextMessages={newMessages}\n            newMessagesFromMembers={newMessages}\n            onPressImageMessage={onPressImageMessage}\n          />\n          <GroupChannelModule.Input\n            SuggestedMentionList={GroupChannelModule.SuggestedMentionList}\n            shouldRenderInput={shouldRenderInput(channel)}\n            onPressSendUserMessage={onPressSendUserMessage}\n            onPressSendFileMessage={onPressSendFileMessage}\n            onPressUpdateUserMessage={onPressUpdateUserMessage}\n            onPressUpdateFileMessage={onPressUpdateFileMessage}\n            onSendFileMessage={onSendFileMessage}\n            onSendUserMessage={onSendUserMessage}\n            onUpdateFileMessage={onUpdateFileMessage}\n            onUpdateUserMessage={onUpdateUserMessage}\n          />\n        </StatusComposition>\n      </GroupChannelModule.Provider>\n    );\n  };\n};\n\nfunction shouldRenderInput(channel: SendbirdGroupChannel) {\n  if (channel.isBroadcast) {\n    return channel.myRole === 'operator';\n  }\n\n  return true;\n}\n\nfunction withFocusingAnimation<P extends unknown & { focused: boolean }>(Component: React.ComponentType<P>) {\n  return React.memo<P>((props) => {\n    const translateY = useRef(new Animated.Value(0)).current;\n\n    useEffect(() => {\n      if (props.focused) {\n        setTimeout(() => {\n          Animated.sequence(\n            [\n              { toValue: -10, duration: 500 },\n              { toValue: 0, duration: 100 },\n              { toValue: -10, duration: 200 },\n              { toValue: 0, duration: 100 },\n            ].map((value) =>\n              Animated.timing(translateY, { ...value, useNativeDriver: true, easing: Easing.inOut(Easing.ease) }),\n            ),\n          ).start();\n        }, MESSAGE_SEARCH_SAFE_SCROLL_DELAY + MESSAGE_FOCUS_ANIMATION_DELAY);\n      }\n    }, [props.focused]);\n\n    return (\n      <Animated.View style={{ transform: [{ translateY }] }}>\n        <Component {...props} />\n      </Animated.View>\n    );\n  });\n}\n\nexport default createGroupChannelFragment;\n"],"mappings":"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"}