{"version":3,"names":["React","TouchableOpacity","useUserList","PASS","getDefaultGroupChannelCreateParams","useFreshCallback","StatusComposition","UserSelectableBar","createUserListModule","useLocalization","useSendbirdChat","createGroupChannelCreateFragment","initModule","UserListModule","_ref","onPressHeaderLeft","onBeforeCreateChannel","onCreateChannel","sortComparator","queryCreator","channelType","renderUser","sdk","currentUser","STRINGS","users","refreshing","loading","error","refresh","next","_renderUser","user","selectedUsers","setSelectedUsers","hasRequiredKey","Object","hasOwn","Error","isMe","userId","userIdx","findIndex","u","isSelected","createElement","activeOpacity","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","disabled","Provider","headerRight","GROUP_CHANNEL_CREATE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","params","invitedUserIds","map","it","currentUserId","isBroadcast","isSuper","processedParams","channel","groupChannel","createChannel","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty"],"sources":["createGroupChannelCreateFragment.tsx"],"sourcesContent":["import React from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport {\n  PASS,\n  SendbirdUser,\n  UserStruct,\n  getDefaultGroupChannelCreateParams,\n  useFreshCallback,\n} from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelCreateFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelCreateFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelCreateFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({\n    onPressHeaderLeft,\n    onBeforeCreateChannel = PASS,\n    onCreateChannel,\n    sortComparator,\n    queryCreator,\n    channelType = 'GROUP',\n    renderUser,\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, loading, error, refresh, next } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const _renderUser: NonNullable<typeof renderUser> = useFreshCallback((user, selectedUsers, setSelectedUsers) => {\n      if (queryCreator && !renderUser) {\n        const hasRequiredKey = Object.hasOwn(user, 'profileUrl') && Object.hasOwn(user, 'nickname');\n        if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n      }\n\n      if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n      const isMe = user.userId === currentUser?.userId;\n      if (isMe) return null;\n\n      const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n      const isSelected = userIdx > -1;\n\n      return (\n        <TouchableOpacity\n          activeOpacity={0.7}\n          onPress={() => {\n            setSelectedUsers(([...draft]) => {\n              if (isSelected) draft.splice(userIdx, 1);\n              else draft.push(user);\n              return draft;\n            });\n          }}\n        >\n          <UserSelectableBar\n            uri={(user as unknown as SendbirdUser).profileUrl}\n            name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n            selected={isSelected}\n            disabled={false}\n          />\n        </TouchableOpacity>\n      );\n    });\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_CREATE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_CREATE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const params = getDefaultGroupChannelCreateParams({\n              invitedUserIds: users.map((it) => it.userId),\n              currentUserId: currentUser?.userId,\n            });\n\n            if (channelType === 'BROADCAST') params.isBroadcast = true;\n            if (channelType === 'SUPER_GROUP') params.isSuper = true;\n\n            const processedParams = await onBeforeCreateChannel(params, users);\n            const channel = await sdk.groupChannel.createChannel(processedParams);\n            onCreateChannel(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelCreateFragment;\n"],"mappings":"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"}