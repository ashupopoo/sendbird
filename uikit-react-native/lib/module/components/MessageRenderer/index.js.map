{"version":3,"names":["React","Pressable","View","createStyleSheet","calcMessageGrouping","conditionChaining","isMyMessage","shouldRenderReaction","useIIFE","DEFAULT_LONG_PRESS_DELAY","useSendbirdChat","ReactionAddons","AdminMessage","FileMessage","MessageContainer","MessageDateSeparator","MessageIncomingAvatar","MessageIncomingSenderName","MessageOutgoingStatus","MessageTime","UnknownMessage","UserMessage","MessageRenderer","_ref","currentUserId","channel","message","onPress","onLongPress","rest","variant","isOutgoing","isIncoming","variantContainerStyle","incoming","styles","chatIncoming","outgoing","chatOutgoing","groupWithPrev","groupWithNext","Boolean","enableMessageGrouping","prevMessage","nextMessage","features","reactionChildren","reactionEnabled","reactions","length","createElement","Message","messageComponent","pressableProps","style","msgContainer","disabled","delayLongPress","messageProps","isUserMessage","_ref2","pressed","_extends","onLongPressURL","onLongPressMentionedUser","isFileMessage","_ref3","isAdminMessage","_ref4","chatGroup","chatNonGroup","chatLastMessage","outgoingContainer","grouping","timeOutgoing","bubbleContainer","bubbleWrapper","timeIncoming","flexDirection","justifyContent","alignItems","marginLeft","marginRight","marginBottom","maxWidth","flexShrink","memo"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport { Pressable, PressableProps, View } from 'react-native';\n\nimport { createStyleSheet } from '@sendbird/uikit-react-native-foundation';\nimport type { SendbirdMessage } from '@sendbird/uikit-utils';\nimport {\n  calcMessageGrouping,\n  conditionChaining,\n  isMyMessage,\n  shouldRenderReaction,\n  useIIFE,\n} from '@sendbird/uikit-utils';\n\nimport { DEFAULT_LONG_PRESS_DELAY } from '../../constants';\nimport type { GroupChannelProps } from '../../domain/groupChannel/types';\nimport { useSendbirdChat } from '../../hooks/useContext';\nimport { ReactionAddons } from '../ReactionAddons';\nimport AdminMessage from './AdminMessage';\nimport FileMessage from './FileMessage';\nimport MessageContainer from './MessageContainer';\nimport MessageDateSeparator from './MessageDateSeparator';\nimport MessageIncomingAvatar from './MessageIncomingAvatar';\nimport MessageIncomingSenderName from './MessageIncomingSenderName';\nimport MessageOutgoingStatus from './MessageOutgoingStatus';\nimport MessageTime from './MessageTime';\nimport UnknownMessage from './UnknownMessage';\nimport UserMessage from './UserMessage';\n\ntype MessageStyleVariant = 'outgoing' | 'incoming';\nexport type MessageRendererInterface<T = SendbirdMessage, AdditionalProps = unknown> = {\n  message: T;\n  prevMessage?: SendbirdMessage;\n  nextMessage?: SendbirdMessage;\n  variant: MessageStyleVariant;\n  groupWithPrev: boolean;\n  groupWithNext: boolean;\n  pressed: boolean;\n  children?: React.ReactElement | null;\n} & AdditionalProps;\n\nconst MessageRenderer: GroupChannelProps['Fragment']['renderMessage'] = ({\n  currentUserId,\n  channel,\n  message,\n  onPress,\n  onLongPress,\n  ...rest\n}) => {\n  const variant: MessageStyleVariant = isMyMessage(message, currentUserId) ? 'outgoing' : 'incoming';\n  const isOutgoing = variant === 'outgoing';\n  const isIncoming = variant === 'incoming';\n  const variantContainerStyle = { incoming: styles.chatIncoming, outgoing: styles.chatOutgoing }[variant];\n\n  const { groupWithPrev, groupWithNext } = calcMessageGrouping(\n    Boolean(rest.enableMessageGrouping),\n    message,\n    rest.prevMessage,\n    rest.nextMessage,\n  );\n\n  const { features } = useSendbirdChat();\n\n  const reactionChildren = useIIFE(() => {\n    if (shouldRenderReaction(channel, features.reactionEnabled) && message.reactions && message.reactions.length > 0) {\n      return <ReactionAddons.Message channel={channel} message={message} />;\n    }\n    return null;\n  });\n\n  const messageComponent = useIIFE(() => {\n    const pressableProps: PressableProps = {\n      style: styles.msgContainer,\n      disabled: !onPress && !onLongPress,\n      onPress,\n      onLongPress,\n      delayLongPress: DEFAULT_LONG_PRESS_DELAY,\n    };\n    const messageProps = { ...rest, variant, groupWithNext, groupWithPrev };\n\n    if (message.isUserMessage()) {\n      return (\n        <Pressable {...pressableProps}>\n          {({ pressed }) => (\n            <UserMessage\n              message={message}\n              pressed={pressed}\n              onLongPressURL={onLongPress}\n              onLongPressMentionedUser={onLongPress}\n              {...messageProps}\n            >\n              {reactionChildren}\n            </UserMessage>\n          )}\n        </Pressable>\n      );\n    }\n\n    if (message.isFileMessage()) {\n      return (\n        <Pressable {...pressableProps}>\n          {({ pressed }) => (\n            <FileMessage message={message} pressed={pressed} {...messageProps}>\n              {reactionChildren}\n            </FileMessage>\n          )}\n        </Pressable>\n      );\n    }\n\n    if (message.isAdminMessage()) {\n      return <AdminMessage message={message} pressed={false} {...messageProps} />;\n    }\n\n    return (\n      <Pressable {...pressableProps}>\n        {({ pressed }) => <UnknownMessage message={message} pressed={pressed} {...messageProps} />}\n      </Pressable>\n    );\n  });\n\n  return (\n    <MessageContainer>\n      <MessageDateSeparator message={message} prevMessage={rest.prevMessage} />\n      {message.isAdminMessage() && messageComponent}\n      {!message.isAdminMessage() && (\n        <View\n          style={[\n            variantContainerStyle,\n            conditionChaining(\n              [groupWithNext, Boolean(rest.nextMessage)],\n              [styles.chatGroup, styles.chatNonGroup, styles.chatLastMessage],\n            ),\n          ]}\n        >\n          {isOutgoing && (\n            <View style={styles.outgoingContainer}>\n              <MessageOutgoingStatus channel={channel} message={message} />\n              <MessageTime message={message} grouping={groupWithNext} style={styles.timeOutgoing} />\n            </View>\n          )}\n          {isIncoming && <MessageIncomingAvatar message={message} grouping={groupWithNext} />}\n          <View style={styles.bubbleContainer}>\n            {isIncoming && <MessageIncomingSenderName message={message} grouping={groupWithPrev} />}\n            <View style={styles.bubbleWrapper}>\n              {messageComponent}\n              {isIncoming && <MessageTime message={message} grouping={groupWithNext} style={styles.timeIncoming} />}\n            </View>\n          </View>\n        </View>\n      )}\n    </MessageContainer>\n  );\n};\n\nconst styles = createStyleSheet({\n  chatIncoming: {\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-end',\n  },\n  chatOutgoing: {\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'flex-end',\n  },\n  timeIncoming: {\n    marginLeft: 4,\n  },\n  timeOutgoing: {\n    marginRight: 4,\n  },\n  chatGroup: {\n    marginBottom: 2,\n  },\n  chatNonGroup: {\n    marginBottom: 16,\n  },\n  chatLastMessage: {\n    marginBottom: 16,\n  },\n  msgContainer: {\n    maxWidth: 240,\n  },\n  bubbleContainer: {\n    flexShrink: 1,\n  },\n  bubbleWrapper: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n  },\n  outgoingContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    justifyContent: 'center',\n  },\n});\n\nexport default React.memo(MessageRenderer);\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,EAAkBC,IAAI,QAAQ,cAAc;AAE9D,SAASC,gBAAgB,QAAQ,yCAAyC;AAE1E,SACEC,mBAAmB,EACnBC,iBAAiB,EACjBC,WAAW,EACXC,oBAAoB,EACpBC,OAAO,QACF,uBAAuB;AAE9B,SAASC,wBAAwB,QAAQ,iBAAiB;AAE1D,SAASC,eAAe,QAAQ,wBAAwB;AACxD,SAASC,cAAc,QAAQ,mBAAmB;AAClD,OAAOC,YAAY,MAAM,gBAAgB;AACzC,OAAOC,WAAW,MAAM,eAAe;AACvC,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,OAAOC,oBAAoB,MAAM,wBAAwB;AACzD,OAAOC,qBAAqB,MAAM,yBAAyB;AAC3D,OAAOC,yBAAyB,MAAM,6BAA6B;AACnE,OAAOC,qBAAqB,MAAM,yBAAyB;AAC3D,OAAOC,WAAW,MAAM,eAAe;AACvC,OAAOC,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,WAAW,MAAM,eAAe;AAcvC,MAAMC,eAA+D,GAAGC,IAAA,IAOlE;EAAA,IAPmE;IACvEC,aAAa;IACbC,OAAO;IACPC,OAAO;IACPC,OAAO;IACPC,WAAW;IACX,GAAGC;EACL,CAAC,GAAAN,IAAA;EACC,MAAMO,OAA4B,GAAGxB,WAAW,CAACoB,OAAO,EAAEF,aAAa,CAAC,GAAG,UAAU,GAAG,UAAU;EAClG,MAAMO,UAAU,GAAGD,OAAO,KAAK,UAAU;EACzC,MAAME,UAAU,GAAGF,OAAO,KAAK,UAAU;EACzC,MAAMG,qBAAqB,GAAG;IAAEC,QAAQ,EAAEC,MAAM,CAACC,YAAY;IAAEC,QAAQ,EAAEF,MAAM,CAACG;EAAa,CAAC,CAACR,OAAO,CAAC;EAEvG,MAAM;IAAES,aAAa;IAAEC;EAAc,CAAC,GAAGpC,mBAAmB,CAC1DqC,OAAO,CAACZ,IAAI,CAACa,qBAAqB,CAAC,EACnChB,OAAO,EACPG,IAAI,CAACc,WAAW,EAChBd,IAAI,CAACe,WAAW,CACjB;EAED,MAAM;IAAEC;EAAS,CAAC,GAAGnC,eAAe,EAAE;EAEtC,MAAMoC,gBAAgB,GAAGtC,OAAO,CAAC,MAAM;IACrC,IAAID,oBAAoB,CAACkB,OAAO,EAAEoB,QAAQ,CAACE,eAAe,CAAC,IAAIrB,OAAO,CAACsB,SAAS,IAAItB,OAAO,CAACsB,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;MAChH,oBAAOjD,KAAA,CAAAkD,aAAA,CAACvC,cAAc,CAACwC,OAAO;QAAC1B,OAAO,EAAEA,OAAQ;QAACC,OAAO,EAAEA;MAAQ,EAAG;IACvE;IACA,OAAO,IAAI;EACb,CAAC,CAAC;EAEF,MAAM0B,gBAAgB,GAAG5C,OAAO,CAAC,MAAM;IACrC,MAAM6C,cAA8B,GAAG;MACrCC,KAAK,EAAEnB,MAAM,CAACoB,YAAY;MAC1BC,QAAQ,EAAE,CAAC7B,OAAO,IAAI,CAACC,WAAW;MAClCD,OAAO;MACPC,WAAW;MACX6B,cAAc,EAAEhD;IAClB,CAAC;IACD,MAAMiD,YAAY,GAAG;MAAE,GAAG7B,IAAI;MAAEC,OAAO;MAAEU,aAAa;MAAED;IAAc,CAAC;IAEvE,IAAIb,OAAO,CAACiC,aAAa,EAAE,EAAE;MAC3B,oBACE3D,KAAA,CAAAkD,aAAA,CAACjD,SAAS,EAAKoD,cAAc,EAC1BO,KAAA;QAAA,IAAC;UAAEC;QAAQ,CAAC,GAAAD,KAAA;QAAA,oBACX5D,KAAA,CAAAkD,aAAA,CAAC7B,WAAW,EAAAyC,QAAA;UACVpC,OAAO,EAAEA,OAAQ;UACjBmC,OAAO,EAAEA,OAAQ;UACjBE,cAAc,EAAEnC,WAAY;UAC5BoC,wBAAwB,EAAEpC;QAAY,GAClC8B,YAAY,GAEfZ,gBAAgB,CACL;MAAA,CACf,CACS;IAEhB;IAEA,IAAIpB,OAAO,CAACuC,aAAa,EAAE,EAAE;MAC3B,oBACEjE,KAAA,CAAAkD,aAAA,CAACjD,SAAS,EAAKoD,cAAc,EAC1Ba,KAAA;QAAA,IAAC;UAAEL;QAAQ,CAAC,GAAAK,KAAA;QAAA,oBACXlE,KAAA,CAAAkD,aAAA,CAACrC,WAAW,EAAAiD,QAAA;UAACpC,OAAO,EAAEA,OAAQ;UAACmC,OAAO,EAAEA;QAAQ,GAAKH,YAAY,GAC9DZ,gBAAgB,CACL;MAAA,CACf,CACS;IAEhB;IAEA,IAAIpB,OAAO,CAACyC,cAAc,EAAE,EAAE;MAC5B,oBAAOnE,KAAA,CAAAkD,aAAA,CAACtC,YAAY,EAAAkD,QAAA;QAACpC,OAAO,EAAEA,OAAQ;QAACmC,OAAO,EAAE;MAAM,GAAKH,YAAY,EAAI;IAC7E;IAEA,oBACE1D,KAAA,CAAAkD,aAAA,CAACjD,SAAS,EAAKoD,cAAc,EAC1Be,KAAA;MAAA,IAAC;QAAEP;MAAQ,CAAC,GAAAO,KAAA;MAAA,oBAAKpE,KAAA,CAAAkD,aAAA,CAAC9B,cAAc,EAAA0C,QAAA;QAACpC,OAAO,EAAEA,OAAQ;QAACmC,OAAO,EAAEA;MAAQ,GAAKH,YAAY,EAAI;IAAA,EAChF;EAEhB,CAAC,CAAC;EAEF,oBACE1D,KAAA,CAAAkD,aAAA,CAACpC,gBAAgB,qBACfd,KAAA,CAAAkD,aAAA,CAACnC,oBAAoB;IAACW,OAAO,EAAEA,OAAQ;IAACiB,WAAW,EAAEd,IAAI,CAACc;EAAY,EAAG,EACxEjB,OAAO,CAACyC,cAAc,EAAE,IAAIf,gBAAgB,EAC5C,CAAC1B,OAAO,CAACyC,cAAc,EAAE,iBACxBnE,KAAA,CAAAkD,aAAA,CAAChD,IAAI;IACHoD,KAAK,EAAE,CACLrB,qBAAqB,EACrB5B,iBAAiB,CACf,CAACmC,aAAa,EAAEC,OAAO,CAACZ,IAAI,CAACe,WAAW,CAAC,CAAC,EAC1C,CAACT,MAAM,CAACkC,SAAS,EAAElC,MAAM,CAACmC,YAAY,EAAEnC,MAAM,CAACoC,eAAe,CAAC,CAChE;EACD,GAEDxC,UAAU,iBACT/B,KAAA,CAAAkD,aAAA,CAAChD,IAAI;IAACoD,KAAK,EAAEnB,MAAM,CAACqC;EAAkB,gBACpCxE,KAAA,CAAAkD,aAAA,CAAChC,qBAAqB;IAACO,OAAO,EAAEA,OAAQ;IAACC,OAAO,EAAEA;EAAQ,EAAG,eAC7D1B,KAAA,CAAAkD,aAAA,CAAC/B,WAAW;IAACO,OAAO,EAAEA,OAAQ;IAAC+C,QAAQ,EAAEjC,aAAc;IAACc,KAAK,EAAEnB,MAAM,CAACuC;EAAa,EAAG,CAEzF,EACA1C,UAAU,iBAAIhC,KAAA,CAAAkD,aAAA,CAAClC,qBAAqB;IAACU,OAAO,EAAEA,OAAQ;IAAC+C,QAAQ,EAAEjC;EAAc,EAAG,eACnFxC,KAAA,CAAAkD,aAAA,CAAChD,IAAI;IAACoD,KAAK,EAAEnB,MAAM,CAACwC;EAAgB,GACjC3C,UAAU,iBAAIhC,KAAA,CAAAkD,aAAA,CAACjC,yBAAyB;IAACS,OAAO,EAAEA,OAAQ;IAAC+C,QAAQ,EAAElC;EAAc,EAAG,eACvFvC,KAAA,CAAAkD,aAAA,CAAChD,IAAI;IAACoD,KAAK,EAAEnB,MAAM,CAACyC;EAAc,GAC/BxB,gBAAgB,EAChBpB,UAAU,iBAAIhC,KAAA,CAAAkD,aAAA,CAAC/B,WAAW;IAACO,OAAO,EAAEA,OAAQ;IAAC+C,QAAQ,EAAEjC,aAAc;IAACc,KAAK,EAAEnB,MAAM,CAAC0C;EAAa,EAAG,CAChG,CACF,CAEV,CACgB;AAEvB,CAAC;AAED,MAAM1C,MAAM,GAAGhC,gBAAgB,CAAC;EAC9BiC,YAAY,EAAE;IACZ0C,aAAa,EAAE,KAAK;IACpBC,cAAc,EAAE,YAAY;IAC5BC,UAAU,EAAE;EACd,CAAC;EACD1C,YAAY,EAAE;IACZwC,aAAa,EAAE,KAAK;IACpBC,cAAc,EAAE,UAAU;IAC1BC,UAAU,EAAE;EACd,CAAC;EACDH,YAAY,EAAE;IACZI,UAAU,EAAE;EACd,CAAC;EACDP,YAAY,EAAE;IACZQ,WAAW,EAAE;EACf,CAAC;EACDb,SAAS,EAAE;IACTc,YAAY,EAAE;EAChB,CAAC;EACDb,YAAY,EAAE;IACZa,YAAY,EAAE;EAChB,CAAC;EACDZ,eAAe,EAAE;IACfY,YAAY,EAAE;EAChB,CAAC;EACD5B,YAAY,EAAE;IACZ6B,QAAQ,EAAE;EACZ,CAAC;EACDT,eAAe,EAAE;IACfU,UAAU,EAAE;EACd,CAAC;EACDT,aAAa,EAAE;IACbE,aAAa,EAAE,KAAK;IACpBE,UAAU,EAAE;EACd,CAAC;EACDR,iBAAiB,EAAE;IACjBM,aAAa,EAAE,KAAK;IACpBE,UAAU,EAAE,UAAU;IACtBD,cAAc,EAAE;EAClB;AACF,CAAC,CAAC;AAEF,4BAAe/E,KAAK,CAACsF,IAAI,CAAChE,eAAe,CAAC"}