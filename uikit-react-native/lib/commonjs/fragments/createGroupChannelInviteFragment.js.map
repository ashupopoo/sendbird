{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_uikitChatHooks","_StatusComposition","_interopRequireDefault","_UserSelectableBar","_createUserListModule","_useContext","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createGroupChannelInviteFragment","initModule","UserListModule","createUserListModule","_ref","channel","onPressHeaderLeft","onInviteMembers","sortComparator","queryCreator","renderUser","sdk","useSendbirdChat","STRINGS","useLocalization","users","refreshing","refresh","next","error","loading","useUserList","memberIds","shouldFilterMember","members","map","it","userId","_renderUser","useCallback","user","selectedUsers","setSelectedUsers","hasRequiredKey","hasOwn","Error","userIdxInMembers","indexOf","userIdxInSelectedUsers","findIndex","isMember","isSelected","createElement","TouchableOpacity","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","Provider","headerRight","GROUP_CHANNEL_INVITE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","userIds","updatedChannel","inviteWithUserIds","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","isSuper","isBroadcast","_default","exports"],"sources":["createGroupChannelInviteFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdGroupChannel, SendbirdUser, UserStruct } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelInviteFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelInviteFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelInviteFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({ channel, onPressHeaderLeft, onInviteMembers, sortComparator, queryCreator, renderUser }) => {\n    const { sdk } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const memberIds = shouldFilterMember(channel) ? channel.members.map((it) => it.userId) : [];\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (queryCreator && !renderUser) {\n          const hasRequiredKey = Object.hasOwn(user, 'profileUrl') && Object.hasOwn(user, 'nickname');\n          if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n        }\n\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdxInMembers = memberIds.indexOf(user.userId);\n        const userIdxInSelectedUsers = selectedUsers.findIndex((it) => it.userId === user.userId);\n\n        const isMember = userIdxInMembers > -1;\n        const isSelected = userIdxInSelectedUsers > -1;\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isMember}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdxInSelectedUsers, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={(user as unknown as SendbirdUser).profileUrl}\n              name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n              selected={isMember || isSelected}\n              disabled={isMember}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser, queryCreator],\n    );\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_INVITE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_INVITE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const userIds = users.map((it) => it.userId);\n            const updatedChannel = await channel.inviteWithUserIds(userIds);\n            onInviteMembers(updatedChannel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nfunction shouldFilterMember(channel: SendbirdGroupChannel) {\n  return !channel.isSuper && !channel.isBroadcast;\n}\n\nexport default createGroupChannelInviteFragment;\n"],"mappings":"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"}