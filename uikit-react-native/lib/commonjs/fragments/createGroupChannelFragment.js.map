{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_uikitChatHooks","_uikitUtils","_MessageRenderer","_interopRequireDefault","_NewMessagesButton","_ScrollToBottomButton","_StatusComposition","_constants","_createGroupChannelModule","_useContext","_pubsub","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createGroupChannelFragment","initModule","GroupChannelModule","createGroupChannelModule","_ref","searchItem","renderNewMessagesButton","props","createElement","renderScrollToBottomButton","renderMessage","enableMessageGrouping","enableTypingIndicator","onPressHeaderLeft","NOOP","onPressHeaderRight","onPressMediaMessage","onChannelDeleted","onBeforeSendUserMessage","PASS","onBeforeSendFileMessage","onBeforeUpdateUserMessage","onBeforeUpdateFileMessage","channel","keyboardAvoidOffset","queryCreator","collectionCreator","sortComparator","messageComparator","flatListProps","onPressImageMessage","sdk","currentUser","useSendbirdChat","internalSearchItem","setInternalSearchItem","useState","navigateFromMessageSearch","useCallback","Boolean","groupChannelPubSub","pubsub","scrolledAwayFromBottom","setScrolledAwayFromBottom","scrolledAwayFromBottomRef","useRefTracker","loading","messages","newMessages","resetNewMessages","next","prev","hasNext","sendFileMessage","sendUserMessage","updateFileMessage","updateUserMessage","resendMessage","deleteMessage","resetWithStartingPoint","useGroupChannelMessages","userId","enableCollectionWithoutLocalCache","shouldCountNewMessages","current","onMessagesReceived","publish","type","data","startingPoint","MessageComponent","withFocusingAnimation","Fragment","MessageRenderer","_renderMessage","useFreshCallback","memoizedFlatListProps","useMemo","ListEmptyComponent","StatusEmpty","contentContainerStyle","flexGrow","onResetMessageList","callback","Number","MAX_SAFE_INTEGER","undefined","onPending","message","onSent","onPressSendUserMessage","params","processedParams","onPressSendFileMessage","onPressUpdateUserMessage","messageId","onPressUpdateFileMessage","onScrolledAwayFromBottom","value","onSendFileMessage","file","onSendUserMessage","text","mention","mentionedUserIds","userIds","mentionedMessageTemplate","messageTemplate","mentionType","onUpdateFileMessage","editedFile","onUpdateUserMessage","editedText","Provider","Header","shouldHideRight","LoadingComponent","StatusLoading","MessageList","currentUserId","onTopReached","onBottomReached","onResendFailedMessage","onDeleteMessage","nextMessages","newMessagesFromMembers","Input","SuggestedMentionList","shouldRenderInput","isBroadcast","myRole","Component","React","memo","translateY","useRef","Animated","Value","useEffect","focused","setTimeout","sequence","toValue","duration","map","timing","useNativeDriver","easing","Easing","inOut","ease","start","MESSAGE_SEARCH_SAFE_SCROLL_DELAY","MESSAGE_FOCUS_ANIMATION_DELAY","View","style","transform","_default","exports"],"sources":["createGroupChannelFragment.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Animated, Easing } from 'react-native';\n\nimport { useGroupChannelMessages } from '@sendbird/uikit-chat-hooks';\nimport {\n  NOOP,\n  PASS,\n  SendbirdFileMessage,\n  SendbirdGroupChannel,\n  SendbirdUserMessage,\n  messageComparator,\n  useFreshCallback,\n  useRefTracker,\n} from '@sendbird/uikit-utils';\n\nimport MessageRenderer from '../components/MessageRenderer';\nimport NewMessagesButton from '../components/NewMessagesButton';\nimport ScrollToBottomButton from '../components/ScrollToBottomButton';\nimport StatusComposition from '../components/StatusComposition';\nimport { MESSAGE_FOCUS_ANIMATION_DELAY, MESSAGE_SEARCH_SAFE_SCROLL_DELAY } from '../constants';\nimport createGroupChannelModule from '../domain/groupChannel/module/createGroupChannelModule';\nimport type {\n  GroupChannelFragment,\n  GroupChannelModule,\n  GroupChannelProps,\n  GroupChannelPubSubContextPayload,\n} from '../domain/groupChannel/types';\nimport { useSendbirdChat } from '../hooks/useContext';\nimport pubsub from '../utils/pubsub';\n\nconst createGroupChannelFragment = (initModule?: Partial<GroupChannelModule>): GroupChannelFragment => {\n  const GroupChannelModule = createGroupChannelModule(initModule);\n\n  return ({\n    searchItem,\n    renderNewMessagesButton = (props) => <NewMessagesButton {...props} />,\n    renderScrollToBottomButton = (props) => <ScrollToBottomButton {...props} />,\n    renderMessage,\n    enableMessageGrouping = true,\n    enableTypingIndicator = true,\n    onPressHeaderLeft = NOOP,\n    onPressHeaderRight = NOOP,\n    onPressMediaMessage = NOOP,\n    onChannelDeleted = NOOP,\n    onBeforeSendUserMessage = PASS,\n    onBeforeSendFileMessage = PASS,\n    onBeforeUpdateUserMessage = PASS,\n    onBeforeUpdateFileMessage = PASS,\n    channel,\n    keyboardAvoidOffset,\n    queryCreator,\n    collectionCreator,\n    sortComparator = messageComparator,\n    flatListProps,\n    onPressImageMessage,\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n\n    const [internalSearchItem, setInternalSearchItem] = useState(searchItem);\n    const navigateFromMessageSearch = useCallback(() => Boolean(searchItem), []);\n\n    const [groupChannelPubSub] = useState(() => pubsub<GroupChannelPubSubContextPayload>());\n    const [scrolledAwayFromBottom, setScrolledAwayFromBottom] = useState(false);\n    const scrolledAwayFromBottomRef = useRefTracker(scrolledAwayFromBottom);\n\n    const {\n      loading,\n      messages,\n      newMessages,\n      resetNewMessages,\n      next,\n      prev,\n      hasNext,\n      sendFileMessage,\n      sendUserMessage,\n      updateFileMessage,\n      updateUserMessage,\n      resendMessage,\n      deleteMessage,\n      resetWithStartingPoint,\n    } = useGroupChannelMessages(sdk, channel, currentUser?.userId, {\n      collectionCreator,\n      queryCreator,\n      sortComparator,\n      onChannelDeleted,\n      enableCollectionWithoutLocalCache: !queryCreator,\n      shouldCountNewMessages: () => scrolledAwayFromBottomRef.current,\n      onMessagesReceived(messages) {\n        groupChannelPubSub.publish({ type: 'MESSAGES_RECEIVED', data: { messages } });\n      },\n      startingPoint: internalSearchItem?.startingPoint,\n    });\n\n    const MessageComponent: GroupChannelProps['MessageList']['renderMessage'] = useCallback(\n      withFocusingAnimation(renderMessage ? (props) => <>{renderMessage(props)}</> : MessageRenderer),\n      [renderMessage],\n    );\n\n    const _renderMessage: GroupChannelProps['MessageList']['renderMessage'] = useFreshCallback((props) => {\n      return <MessageComponent {...props} />;\n    });\n\n    const memoizedFlatListProps = useMemo(\n      () => ({\n        ListEmptyComponent: <GroupChannelModule.StatusEmpty />,\n        contentContainerStyle: { flexGrow: 1 },\n        ...flatListProps,\n      }),\n      [flatListProps],\n    );\n\n    const onResetMessageList = useCallback((callback?: () => void) => {\n      resetWithStartingPoint(Number.MAX_SAFE_INTEGER, callback);\n      setInternalSearchItem(undefined);\n    }, []);\n\n    const onPending = (message: SendbirdFileMessage | SendbirdUserMessage) => {\n      groupChannelPubSub.publish({ type: 'MESSAGE_SENT_PENDING', data: { message } });\n    };\n\n    const onSent = (message: SendbirdFileMessage | SendbirdUserMessage) => {\n      groupChannelPubSub.publish({ type: 'MESSAGE_SENT_SUCCESS', data: { message } });\n    };\n\n    const onPressSendUserMessage: GroupChannelProps['Input']['onPressSendUserMessage'] = useFreshCallback(\n      async (params) => {\n        const processedParams = await onBeforeSendUserMessage(params);\n        const message = await sendUserMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    const onPressSendFileMessage: GroupChannelProps['Input']['onPressSendFileMessage'] = useFreshCallback(\n      async (params) => {\n        const processedParams = await onBeforeSendFileMessage(params);\n        const message = await sendFileMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    const onPressUpdateUserMessage: GroupChannelProps['Input']['onPressUpdateUserMessage'] = useFreshCallback(\n      async (message, params) => {\n        const processedParams = await onBeforeUpdateUserMessage(params);\n        await updateUserMessage(message.messageId, processedParams);\n      },\n    );\n    const onPressUpdateFileMessage: GroupChannelProps['Input']['onPressUpdateFileMessage'] = useFreshCallback(\n      async (message, params) => {\n        const processedParams = await onBeforeUpdateFileMessage(params);\n        await updateFileMessage(message.messageId, processedParams);\n      },\n    );\n    const onScrolledAwayFromBottom = useFreshCallback((value: boolean) => {\n      if (!value) resetNewMessages();\n      setScrolledAwayFromBottom(value);\n    });\n\n    /** @deprecated **/\n    const onSendFileMessage: GroupChannelProps['Input']['onSendFileMessage'] = useFreshCallback(async (file) => {\n      const processedParams = await onBeforeSendFileMessage({ file });\n      const message = await sendFileMessage(processedParams, onPending);\n      onSent(message);\n    });\n    /** @deprecated **/\n    const onSendUserMessage: GroupChannelProps['Input']['onSendUserMessage'] = useFreshCallback(\n      async (text, mention) => {\n        const processedParams = await onBeforeSendUserMessage({\n          message: text,\n          mentionedUserIds: mention?.userIds,\n          mentionedMessageTemplate: mention?.messageTemplate,\n          mentionType: mention?.type,\n        });\n        const message = await sendUserMessage(processedParams, onPending);\n        onSent(message);\n      },\n    );\n    /** @deprecated **/\n    const onUpdateFileMessage: GroupChannelProps['Input']['onUpdateFileMessage'] = useFreshCallback(\n      async (editedFile, message) => {\n        const processedParams = await onBeforeSendFileMessage({ file: editedFile });\n        await updateFileMessage(message.messageId, processedParams);\n      },\n    );\n    /** @deprecated **/\n    const onUpdateUserMessage: GroupChannelProps['Input']['onUpdateUserMessage'] = useFreshCallback(\n      async (editedText, message, mention) => {\n        const processedParams = await onBeforeSendUserMessage({\n          message: editedText,\n          mentionedUserIds: mention?.userIds,\n          mentionedMessageTemplate: mention?.messageTemplate,\n          mentionType: mention?.type,\n        });\n        await updateUserMessage(message.messageId, processedParams);\n      },\n    );\n\n    return (\n      <GroupChannelModule.Provider\n        channel={channel}\n        groupChannelPubSub={groupChannelPubSub}\n        enableTypingIndicator={enableTypingIndicator}\n        keyboardAvoidOffset={keyboardAvoidOffset}\n      >\n        <GroupChannelModule.Header\n          shouldHideRight={navigateFromMessageSearch}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={onPressHeaderRight}\n        />\n        <StatusComposition loading={loading} LoadingComponent={<GroupChannelModule.StatusLoading />}>\n          <GroupChannelModule.MessageList\n            channel={channel}\n            searchItem={internalSearchItem}\n            onResetMessageList={onResetMessageList}\n            enableMessageGrouping={enableMessageGrouping}\n            currentUserId={currentUser?.userId}\n            renderMessage={_renderMessage}\n            messages={messages}\n            newMessages={newMessages}\n            onTopReached={prev}\n            onBottomReached={next}\n            hasNext={hasNext}\n            scrolledAwayFromBottom={scrolledAwayFromBottom}\n            onScrolledAwayFromBottom={onScrolledAwayFromBottom}\n            renderNewMessagesButton={renderNewMessagesButton}\n            renderScrollToBottomButton={renderScrollToBottomButton}\n            onResendFailedMessage={resendMessage}\n            onDeleteMessage={deleteMessage}\n            onPressMediaMessage={onPressMediaMessage}\n            flatListProps={memoizedFlatListProps}\n            nextMessages={newMessages}\n            newMessagesFromMembers={newMessages}\n            onPressImageMessage={onPressImageMessage}\n          />\n          <GroupChannelModule.Input\n            SuggestedMentionList={GroupChannelModule.SuggestedMentionList}\n            shouldRenderInput={shouldRenderInput(channel)}\n            onPressSendUserMessage={onPressSendUserMessage}\n            onPressSendFileMessage={onPressSendFileMessage}\n            onPressUpdateUserMessage={onPressUpdateUserMessage}\n            onPressUpdateFileMessage={onPressUpdateFileMessage}\n            onSendFileMessage={onSendFileMessage}\n            onSendUserMessage={onSendUserMessage}\n            onUpdateFileMessage={onUpdateFileMessage}\n            onUpdateUserMessage={onUpdateUserMessage}\n          />\n        </StatusComposition>\n      </GroupChannelModule.Provider>\n    );\n  };\n};\n\nfunction shouldRenderInput(channel: SendbirdGroupChannel) {\n  if (channel.isBroadcast) {\n    return channel.myRole === 'operator';\n  }\n\n  return true;\n}\n\nfunction withFocusingAnimation<P extends unknown & { focused: boolean }>(Component: React.ComponentType<P>) {\n  return React.memo<P>((props) => {\n    const translateY = useRef(new Animated.Value(0)).current;\n\n    useEffect(() => {\n      if (props.focused) {\n        setTimeout(() => {\n          Animated.sequence(\n            [\n              { toValue: -10, duration: 500 },\n              { toValue: 0, duration: 100 },\n              { toValue: -10, duration: 200 },\n              { toValue: 0, duration: 100 },\n            ].map((value) =>\n              Animated.timing(translateY, { ...value, useNativeDriver: true, easing: Easing.inOut(Easing.ease) }),\n            ),\n          ).start();\n        }, MESSAGE_SEARCH_SAFE_SCROLL_DELAY + MESSAGE_FOCUS_ANIMATION_DELAY);\n      }\n    }, [props.focused]);\n\n    return (\n      <Animated.View style={{ transform: [{ translateY }] }}>\n        <Component {...props} />\n      </Animated.View>\n    );\n  });\n}\n\nexport default createGroupChannelFragment;\n"],"mappings":"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"}