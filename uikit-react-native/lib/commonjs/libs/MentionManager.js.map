{"version":3,"names":["_react","_interopRequireDefault","require","_uikitReactNativeFoundation","_uikitUtils","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","MentionManager","constructor","config","mentionEnabled","_this","inRangeUnderOver","start","num","end","inRangeUnderMore","inRangeLessOver","inRangeLessMore","overlaps","a","b","compare","arguments","length","inRange","underOver","underMore","lessOver","lessMore","text","selectionIndex","lastSpan","slice","split","delimiter","pop","triggerIdx","indexOf","trigger","mentionSpan","searchString","isTriggered","startsWith","isValidSearchString","_invalidStartsKeywords","every","it","offset","mentionedUsers","map","range","selection","lastSelection","removedOffset","filtered","filter","shouldRemove","rangeHelpers","Math","max","user","userId","nickname","leftText","components","sort","reduce","_ref","curr","currentIndex","leftSpan","rightSpan","createElement","Text","style","styles","mentionedText","strings","_ref2","templateSpan","asMentionedMessageTemplate","join","template","actualMentionedUsers","offsetToMove","replaceWithRegex","templateRegex","_ref3","match","matchIndex","groups","find","userIdSpan","userNicknameSpan","asMentionedMessageText","offsetAfterConverted","originalRange","convertedRange","push","message","Boolean","mentionedMessageTemplate","_templateRegex","createMentionTemplateRegex","createStyleSheet","fontWeight","_default","exports"],"sources":["MentionManager.tsx"],"sourcesContent":["import React from 'react';\n\nimport { Text, createStyleSheet } from '@sendbird/uikit-react-native-foundation';\nimport type { SendbirdFileMessage, SendbirdUser, SendbirdUserMessage } from '@sendbird/uikit-utils';\nimport { createMentionTemplateRegex, replaceWithRegex } from '@sendbird/uikit-utils';\n\nimport type { MentionedUser, Range } from '../types';\nimport type { MentionConfigInterface } from './MentionConfig';\n\nclass MentionManager {\n  private _invalidStartsKeywords: string[];\n  private _templateRegex: RegExp;\n\n  constructor(public config: MentionConfigInterface, public mentionEnabled: boolean) {\n    this._invalidStartsKeywords = [this.config.trigger, this.config.delimiter];\n    this._templateRegex = createMentionTemplateRegex(this.config.trigger);\n  }\n\n  public rangeHelpers = {\n    inRangeUnderOver(start: number, num: number, end: number) {\n      return start < num && num < end;\n    },\n    inRangeUnderMore(start: number, num: number, end: number) {\n      return start < num && num <= end;\n    },\n    inRangeLessOver(start: number, num: number, end: number) {\n      return start <= num && num < end;\n    },\n    inRangeLessMore(start: number, num: number, end: number) {\n      return start <= num && num <= end;\n    },\n    overlaps(a: Range, b: Range, compare: 'underOver' | 'underMore' | 'lessOver' | 'lessMore' = 'underOver') {\n      const inRange = {\n        underOver: this.inRangeUnderOver,\n        underMore: this.inRangeUnderMore,\n        lessOver: this.inRangeLessOver,\n        lessMore: this.inRangeLessMore,\n      }[compare];\n\n      return inRange(a.start, b.start, a.end) || inRange(a.start, b.end, a.end);\n    },\n  };\n\n  public get templateRegex() {\n    return this._templateRegex;\n  }\n\n  public getSearchString = (text: string, selectionIndex: number) => {\n    const lastSpan = text.slice(0, selectionIndex).split(this.config.delimiter).pop() ?? '';\n    const triggerIdx = lastSpan.indexOf(this.config.trigger);\n    const mentionSpan = triggerIdx === -1 ? lastSpan : lastSpan.slice(triggerIdx);\n    const searchString = mentionSpan.slice(this.config.trigger.length);\n\n    return {\n      searchString,\n      isTriggered: () => mentionSpan.startsWith(this.config.trigger),\n      isValidSearchString: () => this._invalidStartsKeywords.every((it) => !searchString.startsWith(it)),\n    };\n  };\n\n  /**\n   * @description Reconcile the range by offset in the mentioned users\n   * */\n  public reconcileRangeOfMentionedUsers = (offset: number, selectionIndex: number, mentionedUsers: MentionedUser[]) => {\n    return mentionedUsers.map((it) => {\n      // Changes only on the right text of selection.\n      if (selectionIndex <= it.range.start) {\n        return {\n          ...it,\n          range: {\n            start: it.range.start + offset,\n            end: it.range.end + offset,\n          },\n        };\n      }\n\n      return it;\n    });\n  };\n\n  /**\n   * @description Remove users who in a range\n   * */\n  public removeMentionedUsersInSelection = (selection: Range, mentionedUsers: MentionedUser[]) => {\n    let lastSelection = 0;\n    let removedOffset = 0;\n    const filtered = mentionedUsers.filter((it) => {\n      const shouldRemove = this.rangeHelpers.overlaps(selection, it.range, 'lessMore');\n      if (shouldRemove) {\n        lastSelection = Math.max(lastSelection, it.range.end);\n        removedOffset -= it.range.end - it.range.start;\n      }\n      return !shouldRemove;\n    });\n\n    return { filtered, lastSelection, removedOffset };\n  };\n\n  public getSearchStringRangeInText = (selectionIndex: number, searchString: string): Range => {\n    return {\n      start: selectionIndex - searchString.length - this.config.trigger.length,\n      end: selectionIndex,\n    };\n  };\n\n  /**\n   * @description User to @{user.id} template format\n   * */\n  public asMentionedMessageTemplate = (user: SendbirdUser, delimiter = false) => {\n    return `${this.config.trigger}{${user.userId}}` + (delimiter ? this.config.delimiter : '');\n  };\n\n  /**\n   * @description User to @user.nickname text format\n   * */\n  public asMentionedMessageText = (user: SendbirdUser, delimiter = false) => {\n    return `${this.config.trigger}${user.nickname}` + (delimiter ? this.config.delimiter : '');\n  };\n\n  /**\n   * @description Bold @user.nickname\n   * */\n  public textToMentionedComponents = (text: string, mentionedUsers: MentionedUser[]) => {\n    if (!this.mentionEnabled || mentionedUsers.length === 0) return text;\n\n    const { leftText, components } = mentionedUsers\n      .sort((a, b) => b.range.start - a.range.start)\n      .reduce(\n        ({ leftText, components }, curr, currentIndex) => {\n          const leftSpan = leftText.slice(0, curr.range.start);\n          const mentionSpan = leftText.slice(curr.range.start, curr.range.end);\n          const rightSpan = leftText.slice(curr.range.end);\n\n          return {\n            leftText: leftSpan,\n            components: [\n              <Text key={mentionSpan + currentIndex} style={styles.mentionedText}>\n                {mentionSpan}\n              </Text>,\n              rightSpan,\n              ...components,\n            ],\n          };\n        },\n        { leftText: text, components: [] as (string | JSX.Element)[] },\n      );\n\n    return [leftText, ...components];\n  };\n\n  public textToMentionedMessageTemplate = (text: string, mentionedUsers: MentionedUser[]) => {\n    if (!this.mentionEnabled) return text;\n\n    const { leftText, strings } = mentionedUsers\n      .sort((a, b) => b.range.start - a.range.start)\n      .reduce(\n        ({ leftText, strings }, curr) => {\n          const leftSpan = leftText.slice(0, curr.range.start);\n          const templateSpan = this.asMentionedMessageTemplate(curr.user);\n          const rightSpan = leftText.slice(curr.range.end);\n\n          return {\n            leftText: leftSpan,\n            strings: [templateSpan, rightSpan, ...strings],\n          };\n        },\n        { leftText: text, strings: [] as string[] },\n      );\n\n    return [leftText, ...strings].join('');\n  };\n\n  /**\n   * @description Convert @{user.id} template to @user.nickname text and MentionedUser[] array.\n   * */\n  public templateToTextAndMentionedUsers = (template: string, mentionedUsers: SendbirdUser[]) => {\n    const actualMentionedUsers: MentionedUser[] = [];\n\n    let offsetToMove = 0;\n    const mentionedText = replaceWithRegex(\n      template,\n      this.templateRegex,\n      ({ match, matchIndex, groups }) => {\n        const user = mentionedUsers.find((it) => it.userId === groups[2]);\n        if (user && typeof matchIndex === 'number') {\n          const userIdSpan = match;\n          const userNicknameSpan = this.asMentionedMessageText(user);\n\n          const offsetAfterConverted = userNicknameSpan.length - userIdSpan.length;\n\n          const originalRange: Range = {\n            start: matchIndex,\n            end: matchIndex + userIdSpan.length,\n          };\n\n          const convertedRange: Range = {\n            start: Math.max(0, originalRange.start + offsetToMove),\n            end: originalRange.end + offsetToMove + offsetAfterConverted,\n          };\n\n          offsetToMove += offsetAfterConverted;\n\n          actualMentionedUsers.push({ range: convertedRange, user });\n          return userNicknameSpan;\n        }\n        return match;\n      },\n      '',\n    ).join('');\n\n    return {\n      mentionedText,\n      mentionedUsers: actualMentionedUsers,\n    };\n  };\n\n  public shouldUseMentionedMessageTemplate = (\n    message?: SendbirdUserMessage | SendbirdFileMessage,\n  ): message is RequiredSpecific<\n    SendbirdUserMessage | SendbirdFileMessage,\n    'mentionedMessageTemplate' | 'mentionedUsers' | 'mentionedUserIds' | 'mentionType'\n  > => {\n    return Boolean(\n      this.mentionEnabled &&\n        message?.mentionedMessageTemplate &&\n        message?.mentionedUsers &&\n        message?.mentionedUsers.length > 0,\n    );\n  };\n}\n\ntype RequiredSpecific<T, K extends keyof T> = T & {\n  [P in K]-?: T[P];\n};\n\nconst styles = createStyleSheet({\n  mentionedText: { fontWeight: 'bold' },\n});\n\nexport default MentionManager;\n"],"mappings":"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"}