{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNativeSafeAreaContext","_uikitReactNativeFoundation","_uikitUtils","_LocalizationCtx","_SendbirdChatCtx","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","WARN_onCreateChannel","UserProfileContext","React","createContext","exports","UserProfileProvider","_ref","children","onCreateChannel","onBeforeCreateChannel","PASS","statusBarTranslucent","chatContext","useContext","SendbirdChatContext","localizationContext","LocalizationContext","Error","__DEV__","Logger","warn","bottom","left","right","useSafeAreaInsets","user","setUser","useState","visible","setVisible","hideMessageButton","setHideMessageButton","show","useCallback","options","Boolean","hide","onDismiss","undefined","userProfileButton","useIIFE","isMe","currentUser","userId","onPressMessageButton","_chatContext$currentU","params","getDefaultGroupChannelCreateParams","invitedUserIds","currentUserId","processedParams","channel","sdk","groupChannel","createChannel","createElement","OutlinedButton","onPress","STRINGS","PROFILE_CARD","BUTTON_MESSAGE","Provider","value","Modal","type","onClose","backgroundStyle","styles","modal","ProfileCard","containerStyle","profileCardContainer","paddingLeft","paddingRight","paddingBottom","uri","profileUrl","username","nickname","LABELS","USER_NO_NAME","bodyLabel","BODY_LABEL","body","BODY","button","createStyleSheet","justifyContent","borderTopLeftRadius","borderTopRightRadius"],"sources":["UserProfileCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useState } from 'react';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\n\nimport { Modal, OutlinedButton, ProfileCard, createStyleSheet } from '@sendbird/uikit-react-native-foundation';\nimport type {\n  SendbirdGroupChannel,\n  SendbirdGroupChannelCreateParams,\n  SendbirdMember,\n  SendbirdUser,\n} from '@sendbird/uikit-utils';\nimport { Logger, PASS, getDefaultGroupChannelCreateParams, useIIFE } from '@sendbird/uikit-utils';\n\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\n\ntype OnCreateChannel = (channel: SendbirdGroupChannel) => void;\ntype OnBeforeCreateChannel = (\n  channelParams: SendbirdGroupChannelCreateParams,\n  users: SendbirdUser[] | SendbirdMember[],\n) => SendbirdGroupChannelCreateParams | Promise<SendbirdGroupChannelCreateParams>;\n\ntype ShowOptions = {\n  hideMessageButton?: boolean;\n};\n\nexport type UserProfileContextType = {\n  show(user: SendbirdUser | SendbirdMember, options?: ShowOptions): void;\n  hide(): void;\n};\n\ntype Props = React.PropsWithChildren<{\n  onCreateChannel?: OnCreateChannel;\n  onBeforeCreateChannel?: OnBeforeCreateChannel;\n  statusBarTranslucent?: boolean;\n}>;\n\nlet WARN_onCreateChannel = false;\n\nexport const UserProfileContext = React.createContext<UserProfileContextType | null>(null);\nexport const UserProfileProvider = ({\n  children,\n  onCreateChannel,\n  onBeforeCreateChannel = PASS,\n  statusBarTranslucent = true,\n}: Props) => {\n  const chatContext = useContext(SendbirdChatContext);\n  const localizationContext = useContext(LocalizationContext);\n\n  if (!chatContext) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationContext) throw new Error('LocalizationContext is not provided');\n\n  if (__DEV__ && !WARN_onCreateChannel && !onCreateChannel) {\n    Logger.warn(\n      'You should pass `userProfile.onCreateChannel` prop to SendbirdUIKitContainer if want to use message in a user profile',\n    );\n    WARN_onCreateChannel = true;\n  }\n\n  const { bottom, left, right } = useSafeAreaInsets();\n\n  const [user, setUser] = useState<SendbirdUser | SendbirdMember>();\n  const [visible, setVisible] = useState(false);\n  const [hideMessageButton, setHideMessageButton] = useState(false);\n\n  const show: UserProfileContextType['show'] = useCallback((user, options) => {\n    setUser(user);\n    setVisible(true);\n    setHideMessageButton(Boolean(options?.hideMessageButton));\n  }, []);\n\n  const hide: UserProfileContextType['hide'] = useCallback(() => {\n    setVisible(false);\n  }, []);\n\n  const onDismiss = () => {\n    setUser(undefined);\n    setHideMessageButton(false);\n  };\n\n  const userProfileButton = useIIFE(() => {\n    const isMe = chatContext.currentUser && user?.userId === chatContext.currentUser.userId;\n    if (isMe) return undefined;\n    if (hideMessageButton) return undefined;\n\n    const onPressMessageButton = async () => {\n      if (user) {\n        const params = getDefaultGroupChannelCreateParams({\n          invitedUserIds: [user.userId],\n          currentUserId: chatContext.currentUser?.userId,\n        });\n\n        const processedParams = await onBeforeCreateChannel(params, [user]);\n        hide();\n        const channel = await chatContext.sdk.groupChannel.createChannel(processedParams);\n\n        if (onCreateChannel) {\n          onCreateChannel(channel);\n        } else {\n          Logger.warn(\n            'Please set `onCreateChannel` before message to user from profile card, see `userProfile` prop in the `SendbirdUIKitContainer` props',\n          );\n        }\n      }\n    };\n\n    return (\n      <OutlinedButton onPress={onPressMessageButton}>\n        {localizationContext.STRINGS.PROFILE_CARD.BUTTON_MESSAGE}\n      </OutlinedButton>\n    );\n  });\n\n  return (\n    <UserProfileContext.Provider value={{ show, hide }}>\n      {children}\n      <Modal\n        type={'slide'}\n        onClose={hide}\n        onDismiss={onDismiss}\n        visible={visible && Boolean(user)}\n        backgroundStyle={styles.modal}\n        statusBarTranslucent={statusBarTranslucent}\n      >\n        {user && (\n          <ProfileCard\n            containerStyle={[\n              styles.profileCardContainer,\n              { paddingLeft: left, paddingRight: right, paddingBottom: bottom },\n            ]}\n            uri={user.profileUrl}\n            username={user.nickname || localizationContext.STRINGS.LABELS.USER_NO_NAME}\n            bodyLabel={localizationContext.STRINGS.PROFILE_CARD.BODY_LABEL}\n            body={localizationContext.STRINGS.PROFILE_CARD.BODY(user)}\n            button={userProfileButton}\n          />\n        )}\n      </Modal>\n    </UserProfileContext.Provider>\n  );\n};\n\nconst styles = createStyleSheet({\n  modal: {\n    justifyContent: 'flex-end',\n  },\n  profileCardContainer: {\n    borderTopLeftRadius: 8,\n    borderTopRightRadius: 8,\n  },\n});\n"],"mappings":"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"}