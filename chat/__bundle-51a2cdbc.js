import{_ as e,A as t,T as n,e as s,f as a,h as i,g as r,U as l,X as u,l as o,a as d,I as c,p as h,q as p,H as m,Y as g,Z as y,$ as f,M as _,a0 as v,R as I,a1 as T,a2 as M,a3 as S,b,c as A,r as E,S as U,a4 as w,V as D,a5 as q,a6 as F,a7 as C,a8 as N,W as R,t as P,w as O,a9 as k,aa as L,i as x,ab as z,ac as Q,ad as G,s as B,ae as j,af as H,ag as W,n as K,ah as V,B as X,ai as Y,aj as Z}from"./__bundle-03ba89c3.js";var $,J=function(a){function i(e){var i=a.call(this)||this;if(i.method=t.POST,i.path="".concat(n),i.params=s({file:e.file,channel_url:e.channelUrl}),e.thumbnailSizes)for(var r=0;r<e.thumbnailSizes.length;r++){var l=e.thumbnailSizes[r],u=l.maxWidth,o=l.maxHeight;i.params["thumbnail".concat(r+1)]="".concat(u,",").concat(o)}return i.requestId=e.requestId,i}return e(i,a),i}(a),ee=function(t){function n(e,n){var s,a,i,r=this;return(r=t.call(this,e,n)||this).url=n.url,r.fileSize=null!==(s=n.file_size)&&void 0!==s?s:0,r.thumbnailSizes=null!==(a=n.thumbnails)&&void 0!==a?a:[],r.requireAuth=null!==(i=n.require_auth)&&void 0!==i&&i,r}return e(n,t),n}(i),te=function(t){function n(e,n){var s,a,i,r=this;return(r=t.call(this,e)||this).replyCount=0,r.mostRepliedUsers=null,r.lastRepliedAt=0,r.updatedAt=0,r.replyCount=null!==(s=n.reply_count)&&void 0!==s?s:0,r.mostRepliedUsers=n.hasOwnProperty("most_replies")&&o("object",n.most_replies)?n.most_replies.map((function(e){return new l(r._iid,e)})):[],r.lastRepliedAt=null!==(a=n.last_replied_at)&&void 0!==a?a:0,r.updatedAt=null!==(i=n.updated_at)&&void 0!==i?i:0,r}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{reply_count:e.replyCount,most_replies:Array.isArray(e.mostRepliedUsers)?e.mostRepliedUsers.map((function(e){return l.payloadify(e)})):[],last_replied_at:e.lastRepliedAt,updated_at:e.updatedAt})):null},n}(u);!function(e){e.ADD="add",e.DELETE="delete"}($||($={}));var ne,se,ae=function(e){this.messageId=0,this.userId=null,this.key=null,this.operation=null,this.updatedAt=0;var t=d("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,s=e.operation?e.operation.toLowerCase():null,a=e.reaction,i=e.updated_at;t&&d("string",n)&&d("string",s)&&c($,s)&&d("string",a)&&a&&d("number",i)&&(this.messageId=t,this.userId=n,this.key=a,this.operation=s,this.updatedAt=i)},ie=function(){function e(e){var t,n,s,a=e.key,i=null!==(s=h([],p(e.user_ids),!1))&&void 0!==s?s:[],r=e.updated_at;d("string",a)&&a&&o("string",i)&&i.length>0&&d("number",r)&&(this.key=a,this.userIds=i,this.updatedAt=r);var l={};try{for(var u=m(this.userIds),c=u.next();!c.done;c=u.next()){l[c.value]=this.updatedAt}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this._version=l}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.payloadify=function(e){return e?s({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}):null},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case $.ADD:t<0&&this.userIds.push(e.userId);break;case $.DELETE:t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}this.updatedAt=Math.max(this.updatedAt,e.updatedAt)}},e}(),re=function(){function e(e){this.key=e.key,this.value=o("string",e.value)?h([],p(e.value),!1):[]}return e.payloadify=function(e){var t;return e?s({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}):null},e}(),le=function(){function e(e){this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=e.width),e.hasOwnProperty("height")&&(this.height=e.height),e.hasOwnProperty("alt")&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return e?s({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}):null},e}(),ue=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new le(e["og:image"]))}return e.payloadify=function(e){return e?s({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?le.payloadify(e.defaultImage):null}):null},e}(),oe=function(){function e(e){var t,n;this.name=null,this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(e){return e?s({name:e.name,volume:e.volume}):null},e}();!function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"}(ne||(ne={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}(se||(se={}));var de,ce=function(e){switch(e){case y.BASE:return"";case y.USER:return"MESG";case y.FILE:return"FILE";case y.ADMIN:return"ADMM"}},he=function(t){function n(e,n){var s,a,i,r,u,o,d,h,p,m,g,f,I,T,M,S=this;(S=t.call(this,e)||this).channelUrl=null,S.channelType=_.BASE,S.messageId=0,S.parentMessageId=null,S.parentMessage=null,S.silent=!1,S.isOperatorMessage=!1,S.messageType=y.BASE,S.data=null,S.customType=null,S.mentionType=null,S.mentionedUsers=[],S.mentionedUserIds=[],S.mentionedMessageTemplate=null,S.threadInfo=null,S.reactions=[],S.metaArrays=[],S.ogMetaData=null,S.appleCriticalAlertOptions=null,S.createdAt=0,S.updatedAt=0,S.scheduledInfo=null,S.extendedMessage={},S._isContinuousMessages=!1,S._scheduledStatus=null,S.messageId=null!==(a=null!==(s=n.msg_id)&&void 0!==s?s:n.message_id)&&void 0!==a?a:0,S.channelUrl=n.channel_url,S.channelType=c(_,n.channel_type)?n.channel_type:_.GROUP,n.channel&&(n.channel.channel_url&&(S.channelUrl=n.channel.channel_url),n.channel.channel_type&&(S.channelType=n.channel.channel_type)),S.parentMessageId=null!==(i="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==i?i:0,S.data=null!==(r=n.data)&&void 0!==r?r:"",S.customType=null!==(u=n.custom_type)&&void 0!==u?u:"",S.mentionType=c(v,n.mention_type)?n.mention_type:null;var b=n.mentioned_users;S.mentionedUsers=b?b.map((function(e){return new l(S._iid,e)})):null;var A=n.mentioned_user_ids;S.mentionedUserIds=null!=A?A:null,S.mentionedUsers&&!S.mentionedUserIds&&(S.mentionedUserIds=S.mentionedUsers.map((function(e){return e.userId}))),S.mentionedMessageTemplate=null!==(o=n.mentioned_message_template)&&void 0!==o?o:"",S.threadInfo=n.thread_info?new te(S._iid,n.thread_info):null,S.reactions=n.reactions?n.reactions.map((function(e){return new ie(e)})):[];for(var E=null!==(d=n.metaarray)&&void 0!==d?d:{},U=null!==(h=n.metaarray_key_order)&&void 0!==h?h:Object.keys(E).sort((function(e,t){return e.localeCompare(t)})),w=0;w<U.length;w++){var D=U[w];S.metaArrays.push(new re({key:D,value:E[D]||[]}))}return n.sorted_metaarray&&(S.metaArrays=n.sorted_metaarray.map((function(e){return new re(e)}))),S.ogMetaData=n.og_tag?new ue(n.og_tag):null,S.silent=null!==(p=n.silent)&&void 0!==p&&p,S.isOperatorMessage=null!==(m=n.is_op_msg)&&void 0!==m&&m,S.appleCriticalAlertOptions=n.apple_critical_alert_options?new oe(n.apple_critical_alert_options):null,S.createdAt=null!==(f=null!==(g=n.created_at)&&void 0!==g?g:n.ts)&&void 0!==f?f:0,S.updatedAt=null!==(I=n.updated_at)&&void 0!==I?I:0,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(S.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},S._scheduledStatus=n.scheduled_status),S.extendedMessage=null!==(T=n.extended_message)&&void 0!==T?T:{},S._isContinuousMessages=null!==(M=n.is_continuous_messages)&&void 0!==M&&M,S}return e(n,t),n.payloadify=function(e){var n,a,i,u;return e?s(r(r({},t.payloadify.call(this,e)),{channel_url:e.channelUrl,channel_type:e.channelType,message_id:e.messageId,type:ce(e.messageType),parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,mentioned_user_ids:e.mentionedUserIds,mentioned_users:null===(n=e.mentionedUsers)||void 0===n?void 0:n.map((function(e){return l.payloadify(e)})),mentioned_message_template:e.mentionedMessageTemplate,thread_info:e.threadInfo?te.payloadify(e.threadInfo):null,reactions:e.reactions.map((function(e){return ie.payloadify(e)})),sorted_metaarray:null===(a=e.metaArrays)||void 0===a?void 0:a.map((function(e){return re.payloadify(e)})),og_tag:ue.payloadify(e.ogMetaData),silent:e.silent,is_op_msg:e.isOperatorMessage,apple_critical_alert_options:oe.payloadify(e.appleCriticalAlertOptions),created_at:e.createdAt,updated_at:e.updatedAt,scheduled_message_id:null===(i=e.scheduledInfo)||void 0===i?void 0:i.scheduledMessageId,scheduled_at:null===(u=e.scheduledInfo)||void 0===u?void 0:u.scheduledAt,scheduled_status:e._scheduledStatus,extended_message:e.extendedMessage})):null},n.prototype.isIdentical=function(e){return this.messageId===e.messageId},n.prototype.isEqual=function(e){return g(this,e)},n.prototype.isUserMessage=function(){return this.messageType===y.USER},n.prototype.isFileMessage=function(){return this.messageType===y.FILE},n.prototype.isAdminMessage=function(){return this.messageType===y.ADMIN},n.prototype.serialize=function(){return f(this)},n.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter((function(t){return e.includes(t.key)}))},n.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1},n.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break}t||"add"!==e.operation||this.reactions.push(new ie(ie.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})))}},n.prototype.applyParentMessage=function(e){if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},n}(u),pe=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.role=null,s.isBlockedByMe=!1,s.role=c(I,n.role)?n.role:I.NONE,n.hasOwnProperty("is_blocked_by_me")&&(s.isBlockedByMe=n.is_blocked_by_me),s}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{role:e.role,is_blocked_by_me:e.isBlockedByMe})):null},n}(l),me=function(t){function n(e,n){var s,a,i,r,l=this;if((l=t.call(this,e,n)||this).sender=null,l.reqId="",l.replyToChannel=!1,l.sendingStatus=null,l.errorCode=0,l.sender=n.user?new pe(l._iid,n.user):n.sender_id,l.reqId=null!==(a=null!==(s=n.req_id)&&void 0!==s?s:n.request_id)&&void 0!==a?a:"",l.replyToChannel=null!==(i=n.is_reply_to_channel)&&void 0!==i&&i,n.request_state&&c(T,n.request_state)&&(l.sendingStatus=n.request_state),!l.sendingStatus)if(l.messageId>0)l.sendingStatus=T.SUCCEEDED;else if(l.scheduledInfo)switch(l._scheduledStatus=n.scheduled_status,n.scheduled_status){case se.SENT:case se.IN_QUEUE:l.sendingStatus=T.SUCCEEDED;break;case se.PENDING:l.sendingStatus=T.SCHEDULED;break;case se.FAILED:case se.REMOVED:l.sendingStatus=T.FAILED;break;case se.CANCELED:l.sendingStatus=T.CANCELED}else l.sendingStatus=T.PENDING;return l.errorCode=null!==(r=n.error_code)&&void 0!==r?r:0,l}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{user:pe.payloadify(e.sender),req_id:e.reqId,is_reply_to_channel:e.replyToChannel,request_state:e.sendingStatus,error_code:e.errorCode})):null},Object.defineProperty(n.prototype,"isResendable",{get:function(){return this.sendingStatus===T.FAILED&&M(this.errorCode)},enumerable:!1,configurable:!0}),n.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},n}(he),ge=function(){function e(e){var t,n;this.url=null,this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this.url=e.url,this.width=e.width,this.height=e.height,this.realWidth=null!==(t=e.real_width)&&void 0!==t?t:e.width,this.realHeight=null!==(n=e.real_height)&&void 0!==n?n:e.height}return e.payloadify=function(e){return e?s({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}):null},Object.defineProperty(e.prototype,"plainUrl",{get:function(){return this.url.split("?auth=")[0]},enumerable:!1,configurable:!0}),e}(),ye={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:S.ALL,customTypesFilter:null,senderUserIdsFilter:null,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},fe=function(e){return d("number",e.prevResultSize)&&d("number",e.nextResultSize)&&d("boolean",e.isInclusive)&&d("boolean",e.reverse)&&d("string",e.messageTypeFilter)&&c(S,e.messageTypeFilter)&&o("string",e.customTypesFilter,!0)&&o("string",e.senderUserIdsFilter,!0)&&d("boolean",e.includeMetaArray)&&d("boolean",e.includeReactions)&&d("boolean",e.includeParentMessageInfo)},_e=function(t){function n(e,n){var s,a,i,l,u=this;if((u=t.call(this,e,n)||this).message=null,u.translations={},u.message=null!==(s=n.message)&&void 0!==s?s:"",u.messageType=y.ADMIN,u.translations=null!==(a=n.translations)&&void 0!==a?a:{},n.parent_message_info){var o=n.parent_message_info,d=r(r({},o),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:o.file,url:null===(i=o.file)||void 0===i?void 0:i.url,require_auth:null===(l=o.file)||void 0===l?void 0:l.require_auth});u.parentMessage=Me(e,d)}return u}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{message:e.message,translations:e.translations,parent_message_info:Te(e.parentMessage)})):null},n.prototype.getThreadedMessagesByTimestamp=function(e,t){return b(this,void 0,void 0,(function(){var n;return A(this,(function(s){switch(s.label){case 0:return n=r(r({},ye),t),E(this.messageId>0&&d("number",e)&&fe(n)).throw(U.invalidParameters),[4,Be.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,s.sent()]}}))}))},n}(he),ve=function(){function e(e){var t,n;this.type=null,this.vendor=null,this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.hasOwnProperty("detail")&&d("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return e?s({type:e.type,vendor:e.vendor,detail:e.detail}):null},e}(),Ie=function(t){function n(e,n){var a,i,l,u,o,d,c,h=this;if((h=t.call(this,e,n)||this).message="",h.messageParams=null,h.translations={},h.translationTargetLanguages=[],h.messageSurvivalSeconds=-1,h.plugins=[],h._poll=null,h.message=n.message,h.messageType=y.USER,h.translations=null!==(l=n.translations)&&void 0!==l?l:{},h.translationTargetLanguages=null!==(u=n.target_langs)&&void 0!==u?u:[],0===Object.keys(h.translations).length&&h.translationTargetLanguages.length>0)try{for(var p=m(h.translationTargetLanguages),g=p.next();!g.done;g=p.next()){var f=g.value;h.translations[f]=""}}catch(e){a={error:e}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}if(h.messageSurvivalSeconds=null!==(o=n.message_survival_seconds)&&void 0!==o?o:-1,h.plugins=n.plugins?n.plugins.map((function(e){return new ve(e)})):[],h._poll=n.poll?new w(h._iid,n.poll):null,n.parent_message_info){var _=n.parent_message_info,v=r(r({},_),{created_at:_.ts,message_id:h.parentMessageId,channel_url:h.channelUrl,channel_type:h.channelType,file:_.file,url:null===(d=_.file)||void 0===d?void 0:d.url,require_auth:null===(c=_.file)||void 0===c?void 0:c.require_auth});h.parentMessage=Me(e,s(v))}return h}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{message:e.message,translations:e.translations,message_survival_seconds:e.messageSurvivalSeconds,plugins:e.plugins.map((function(e){return ve.payloadify(e)})),poll:w.payloadify(e._poll),parent_message_info:Te(e.parentMessage)})):null},n.prototype.getThreadedMessagesByTimestamp=function(e,t){return b(this,void 0,void 0,(function(){var n;return A(this,(function(s){switch(s.label){case 0:return n=r(r({},ye),t),E(this.messageId>0&&d("number",e)&&fe(n)).throw(U.invalidParameters),[4,Be.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,s.sent()]}}))}))},n.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(n.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),n}(me),Te=function(e){if(e)switch(e.messageType){case y.USER:return Ie.payloadify(e);case y.FILE:return Se.payloadify(e);case y.ADMIN:return _e.payloadify(e)}return null},Me=function(e,t){switch(t.type){case"MESG":return new Ie(e,t);case"FILE":return new Se(e,t);case"ADMM":case"BRDM":return new _e(e,t)}return null},Se=function(t){function n(e,n){var s,a,i,l,u,o,d,c,h,p,m,g,f,_,v,I=this;(I=t.call(this,e,n)||this).messageParams=null,I.plainUrl="",I.requireAuth=!1,I.name=null,I.size=0,I.type=null,I.thumbnails=[],I.messageSurvivalSeconds=-1,I.messageType=y.FILE;var T=null!==(s=n.file)&&void 0!==s?s:null;I.plainUrl=(null!==(i=null!==(a=null==T?void 0:T.url)&&void 0!==a?a:n.url)&&void 0!==i?i:"").split("?auth=")[0],I.name=null!==(u=null!==(l=null==T?void 0:T.name)&&void 0!==l?l:n.name)&&void 0!==u?u:"File",I.size=null!==(d=null!==(o=null==T?void 0:T.size)&&void 0!==o?o:n.size)&&void 0!==d?d:0,I.data=null!==(h=null!==(c=null==T?void 0:T.data)&&void 0!==c?c:n.custom)&&void 0!==h?h:"",I.type=T?null!==(p=T.type)&&void 0!==p?p:"":null!==(m=n.type)&&void 0!==m?m:"";var M=D.of(I._iid).sessionManager;if(I.requireAuth=null!==(g=n.require_auth)&&void 0!==g&&g,I.thumbnails=n.thumbnails?n.thumbnails.map((function(e){return new ge(r(r({},e),{url:"".concat(e.url.split("?auth=")[0]).concat(I.requireAuth?"?auth=".concat(M.ekey):"")}))})):[],I.messageSurvivalSeconds=null!==(f=n.message_survival_seconds)&&void 0!==f?f:-1,n.parent_message_info){var S=n.parent_message_info,b=r(r({},S),{message_id:I.parentMessageId,channel_url:I.channelUrl,channel_type:I.channelType,file:S.file,url:null===(_=S.file)||void 0===_?void 0:_.url,require_auth:null===(v=S.file)||void 0===v?void 0:v.require_auth});I.parentMessage=Me(e,b)}return I}return e(n,t),n.payloadify=function(e){return e?s(r(r({},t.payloadify.call(this,e)),{url:e.plainUrl,require_auth:e.requireAuth,file:{name:e.name,size:e.size,type:e.type,data:e.data},thumbnails:e.thumbnails.map((function(e){return{url:e.url,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),message_survival_seconds:e.messageSurvivalSeconds,parent_message_info:Te(e.parentMessage)})):null},Object.defineProperty(n.prototype,"url",{get:function(){var e=D.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),n.prototype.getThreadedMessagesByTimestamp=function(e,t){return b(this,void 0,void 0,(function(){var n;return A(this,(function(s){switch(s.label){case 0:return n=r(r({},ye),t),E(this.messageId>0&&d("number",e)&&fe(n)).throw(U.invalidParameters),[4,Be.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,s.sent()]}}))}))},n}(me),be=function(t){function n(e){var n,a,i,r=[];return e.mentionType===v.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map((function(e){return e.userId})))),t.call(this,{code:"FILE",ackRequired:!0,payload:s({channel_url:e.channelUrl,url:e.url,name:null!==(n=e.fileName)&&void 0!==n?n:"",type:null!==(a=e.mimeType)&&void 0!==a?a:"",size:null!==(i=e.fileSize)&&void 0!==i?i:0,custom:e.data,custom_type:e.customType,thumbnails:e.thumbnailSizes,require_auth:e.requireAuth,metaarray:e.metaArrays,mention_type:e.mentionType,mentioned_user_ids:r,push_option:e.pushNotificationDeliveryOption&&e.pushNotificationDeliveryOption!==q.DEFAULT?e.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:e.appleCriticalAlertOptions,silent:e.silent,reply_to_channel:e.isReplyToChannel,parent_message_id:e.parentMessageId>0?e.parentMessageId:null,req_id:e.reqId,pin_message:e.isPinnedMessage})})||this}return e(n,t),n}(F),Ae=function(n){function a(e){var a,i=this;i=n.call(this)||this;var r=[];return e.mentionType===v.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map((function(e){return e.userId})))),i.method=t.POST,i.path="".concat(C(e.channelType),"/").concat(encodeURIComponent(e.channelUrl),"/messages"),i.params=s({message_type:y.FILE,user_id:e.userId,url:e.fileUrl,mention_type:e.mentionType,mentioned_user_ids:r,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,data:e.data,custom_type:e.customType,thumbnails:e.thumbnailSizes.map((function(e){return ge.payloadify(e)})),require_auth:e.requireAuth,sorted_metaarray:null===(a=e.metaArrays)||void 0===a?void 0:a.map((function(e){return re.payloadify(e)})),push_option:e.pushNotificationDeliveryOption,parent_message_id:e.parentMessageId>0?e.parentMessageId:null,apple_critical_alert_options:oe.payloadify(e.appleCriticalAlertOptions),reply_to_channel:e.isReplyToChannel,req_id:e.reqId,pin_message:e.isPinnedMessage}),i}return e(a,n),a}(a),Ee=function(t){function n(e,n,s){var a,i,r,l=this;(l=t.call(this,e,"FILE",s)||this).message=new Se(e,s);var u=D.of(e).sdkState;return l.isMentioned=N(l.message.mentionType,null!==(a=l.message.mentionedUserIds)&&void 0!==a?a:null===(i=l.message.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})),u.userId),l.forceUpdateLastMessage=null!==(r=s.force_update_last_message)&&void 0!==r&&r,l}return e(n,t),n}(R),Ue=function(t){function n(e,n){var s,a,i=this;(i=t.call(this,e,n)||this).message=new Se(e,n);var r=D.of(e).sdkState;return i.isMentioned=N(i.message.mentionType,null!==(s=i.message.mentionedUserIds)&&void 0!==s?s:i.message.mentionedUsers.map((function(e){return e.userId})),r.userId),i.forceUpdateLastMessage=null!==(a=n.force_update_last_message)&&void 0!==a&&a,i}return e(n,t),n}(i);!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"}(de||(de={}));var we,De=function(){function e(e,t){var n=t.sdkState,s=t.dispatcher,a=t.requestQueue,i=t.onlineDetector,r=t.cacheContext,l=this;this._queueMap=new Map,this._connectionState=null,this._onlineDetector=null,this._iid=e,this._sdkState=n,this._requestQueue=a,this._cacheContext=r,this._dispatcher=s,this._dispatcher.on((function(e){e instanceof P&&(l._connectionState=e.stateType)})),this._onlineDetector=i}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===O.CONNECTED||this._connectionState===O.CONNECTING||this._connectionState===O.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return b(this,void 0,void 0,(function(){var n,s;return A(this,(function(a){switch(a.label){case 0:return this._shouldSendThroughWebSocket?(n=new be(r(r({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(n)]):[3,2];case 1:return s=a.sent(),[2,s.as(Ee).message];case 2:return n=new Ae(r(r({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,userId:this._sdkState.userId,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(n)];case 3:return s=a.sent(),[2,s.as(Ue).message]}}))}))},e.prototype._resolveMessageQueue=function(e){return b(this,void 0,void 0,(function(){var t,n,s,a,i,r,l,u,o,d,c,h;return A(this,(function(p){switch(p.label){case 0:if(!(t=this._queueMap.get(e.url)))return[3,21];if(t.isResolving)return[3,20];t.isResolving=!0,n=[],s=!0,p.label=1;case 1:p.trys.push([1,15,16,17]),a=m(t.messageQueue),i=a.next(),p.label=2;case 2:if(i.done)return[3,14];switch(r=i.value,r.state){case de.PENDING:case de.UPLOADING:return[3,3];case de.UPLOADED:return[3,4];case de.FAILED:return[3,12]}return[3,13];case 3:return s=!1,n.push(r),[3,13];case 4:if(!s)return[3,10];p.label=5;case 5:return p.trys.push([5,8,,9]),r.state=de.SENDING,[4,this._sendFileMessage(e,r)];case 6:return l=p.sent(),r.deferred.resolve(l),[4,L(100)];case 7:return p.sent(),[3,9];case 8:return u=p.sent(),r.deferred.reject(u),[3,9];case 9:return[3,11];case 10:n.push(r),p.label=11;case 11:return[3,13];case 12:return r.deferred.reject(r.error.code===k.REQUEST_CANCELED?U.fileUploadCanceled:r.error),[3,13];case 13:return i=a.next(),[3,2];case 14:return[3,17];case 15:return o=p.sent(),c={error:o},[3,17];case 16:try{i&&!i.done&&(h=a.return)&&h.call(a)}finally{if(c)throw c.error}return[7];case 17:return d=t.isResolveRequestPending,t.messageQueue=n,t.isResolving=!1,t.isResolveRequestPending=!1,d?[4,this._resolveMessageQueue(e)]:[3,19];case 18:p.sent(),p.label=19;case 19:return[3,21];case 20:t.isResolveRequestPending=!0,p.label=21;case 21:return[2]}}))}))},e.prototype._uploadNextPendingItem=function(e){return b(this,void 0,void 0,(function(){var t,n,s,a,i,r,l,u,o,d,c,h,p,m;return A(this,(function(g){switch(g.label){case 0:return t=this._queueMap.get(e.url),(n=t.messageQueue.find((function(e){return e.state===de.PENDING})))?x(n.params.file)?t.uploadQueue.length<6?(n.state=de.UPLOADING,t.uploadQueue.push(n),[4,this._onlineDetector.isOnline()]):[3,10]:[3,11]:[3,13];case 1:if(!g.sent())return[3,8];g.label=2;case 2:return g.trys.push([2,4,5,7]),s=new J({file:n.params.file,channelUrl:e.url,thumbnailSizes:n.params.thumbnailSizes,requestId:n.requestId}),[4,this._requestQueue.send(s)];case 3:return a=g.sent(),i=a.as(ee),r=i.url,l=i.fileSize,u=void 0===l?n.params.fileSize:l,o=i.thumbnailSizes,d=void 0===o?n.params.thumbnailSizes:o,c=i.requireAuth,h=void 0!==c&&c,n.params.fileUrl=r,n.params.fileSize=u,n.params.thumbnailSizes=d,n.params.requireAuth=h,n.requireAuth=h,n.state=de.UPLOADED,[3,7];case 4:return(p=g.sent()).code===k.REQUEST_FAILED?n.error=new U({code:k.NETWORK_ERROR,message:"Failed to upload a file."}):n.error=p,n.state=de.FAILED,[3,7];case 5:return(m=t.uploadQueue.findIndex((function(e){return e.requestId===n.requestId})))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 6:return g.sent(),[7];case 7:return[3,10];case 8:return n.state=de.FAILED,n.error=U.connectionRequired,(m=t.uploadQueue.findIndex((function(e){return e.requestId===n.requestId})))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 9:g.sent(),g.label=10;case 10:return[3,13];case 11:return n.params.thumbnailSizes=[],n.state=de.UPLOADED,[4,this._resolveMessageQueue(e)];case 12:g.sent(),g.label=13;case 13:return[2]}}))}))},e.prototype.request=function(e,t,n){var s,a,i;return b(this,void 0,void 0,(function(){var r;return A(this,(function(l){return r=new z,x(n.file)&&(n.fileName=null!==(s=n.fileName)&&void 0!==s?s:n.file.name,n.mimeType=null!==(a=n.mimeType)&&void 0!==a?a:n.file.type,n.fileSize=null!==(i=n.fileSize)&&void 0!==i?i:n.file.size),this._queueMap.has(e.url)||this._queueMap.set(e.url,{messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1}),this._queueMap.get(e.url).messageQueue.push({requestId:t,params:n,state:de.PENDING,deferred:r,requireAuth:n.requireAuth}),this._uploadNextPendingItem(e),[2,r.promise]}))}))},e.prototype.cancel=function(e,t){var n,s;void 0===t&&(t=null);var a=this._queueMap.get(e.url);if(a){var i=t?[a.messageQueue.find((function(e){return e.requestId===t}))]:h([],p(a.messageQueue),!1);try{for(var r=m(i),l=r.next();!l.done;l=r.next()){var u=l.value;if(u)switch(u.state){case de.PENDING:u.state=de.FAILED,u.error=U.requestCanceled,this._resolveMessageQueue(e);break;case de.UPLOADING:this._requestQueue.cancel(u.requestId)}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}}},e}(),qe={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:S.ALL,customTypesFilter:null,senderUserIdsFilter:null,replyType:Q.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},Fe=function(e){return d("number",e.prevResultSize)&&d("number",e.nextResultSize)&&d("boolean",e.isInclusive)&&d("boolean",e.reverse)&&d("string",e.messageTypeFilter)&&c(S,e.messageTypeFilter)&&o("string",e.customTypesFilter,!0)&&o("string",e.senderUserIdsFilter,!0)&&c(Q,e.replyType)&&d("boolean",e.includeMetaArray)&&d("boolean",e.includeReactions)&&d("boolean",e.includeParentMessageInfo)&&d("boolean",e.includeThreadInfo)&&d("boolean",e.showSubchannelMessagesOnly)},Ce={replyType:Q.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Ne=function(e){return c(Q,e.replyType)&&d("boolean",e.includeReactions)&&d("boolean",e.includeMetaArray)&&d("boolean",e.includeParentMessageInfo)&&d("boolean",e.includeThreadInfo)},Re=function(n){function s(e){var s=e.channelType,a=e.channelUrl,i=e.messageId,r=e.includeMetaArray,l=e.includeReactions,u=e.includeThreadInfo,o=e.includeParentMessageInfo,d=n.call(this)||this;return d.method=t.GET,d.path="".concat(C(s),"/").concat(encodeURIComponent(a),"/messages/").concat(encodeURIComponent(i)),d.params={is_sdk:!0,with_sorted_meta_array:r,include_reactions:l,include_thread_info:u,include_parent_message_info:o,include_poll_details:!0},d}return e(s,n),s}(a),Pe=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.message=n?Me(e,r({},n)):null,s}return e(n,t),n}(i),Oe=function(n){function a(e){var a=e.channelType,i=e.channelUrl,r=e.timestamp,l=void 0===r?null:r,u=e.token,o=void 0===u?null:u,d=e.prevResultSize,c=e.nextResultSize,h=e.isInclusive,p=e.reverse,m=e.messageTypeFilter,g=e.customTypesFilter,y=e.senderUserIdsFilter,f=e.replyType,_=e.includeMetaArray,v=e.includeReactions,I=e.parentMessageId,T=e.includeThreadInfo,M=e.includeParentMessageInfo,S=e.showSubchannelMessagesOnly,b=e.checkingContinuousMessages,A=n.call(this)||this;return A.method=t.GET,A.path="".concat(C(a),"/").concat(encodeURIComponent(i),"/messages"),A.params=s({is_sdk:!0,prev_limit:d,next_limit:c,include:h,reverse:p,message_ts:l,message_id:o,message_type:null!=m?m:null,custom_types:g,sender_ids:y,include_reply_type:f,with_sorted_meta_array:_,include_reactions:v,parent_message_id:I,include_thread_info:T,include_parent_message_info:M,show_subchannel_message_only:S,include_poll_details:!0,checking_continuous_messages:b}),A}return e(a,n),a}(a),ke=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.messages=n.messages.map((function(t){return Me(e,t)})),s}return e(n,t),n}(i),Le=function(n){function s(e){var s=e.channelType,a=e.channelUrl,i=e.timestamp,r=e.token,l=e.replyType,u=e.includeMetaArray,o=e.includeReactions,d=e.includeThreadInfo,c=e.includeParentMessageInfo,h=n.call(this)||this;return h.method=t.GET,h.path="".concat(C(s),"/").concat(encodeURIComponent(a),"/messages/changelogs"),h.params={change_ts:i,token:r,with_sorted_meta_array:u,include_reactions:o,include_thread_info:d,include_reply_type:l,include_parent_message_info:c,include_poll_details:!0},h}return e(s,n),s}(a),xe=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.updatedMessages=n.updated.map((function(t){return Me(e,t)})),s.deletedMessagesInfo=n.deleted.map((function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}})),s.hasMore=n.has_more,s.nextToken=n.next,s}return e(n,t),n}(i),ze=function(n){function s(e){var s=e.channelUrl,a=e.scheduledMessageId,i=n.call(this)||this;return i.method=t.GET,i.path="".concat(G,"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(a)),i.params={},i}return e(s,n),s}(a),Qe=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.message=n?Me(e,r({},n)):null,s}return e(n,t),n}(i),Ge={},Be=function(){function e(e,t){var n=t.sdkState,s=t.dispatcher,a=t.requestQueue,i=t.onlineDetector,r=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=a,this._dispatcher=s,this._cacheContext=r,this.fileMessageQueue=new De(e,{sdkState:n,dispatcher:s,requestQueue:a,onlineDetector:i,cacheContext:r}),Ge[e]=this}return e.of=function(e){return Ge[e]},e.prototype.buildMessageFromSerializedData=function(e){var t=B(e);switch(t.messageType){case y.USER:return new Ie(this._iid,Ie.payloadify(t));case y.FILE:return new Se(this._iid,Se.payloadify(t));case y.ADMIN:return new _e(this._iid,_e.payloadify(t))}return null},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return s({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId})},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){return s({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:t.thumbnails.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),fileType:e.fileType,requireAuth:t.requireAuth})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return r(r({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return r(r({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=B(e);return new pe(this._iid,pe.payloadify(t))},e.prototype.getMessage=function(e){return b(this,void 0,void 0,(function(){var t,n;return A(this,(function(s){switch(s.label){case 0:return t=new Re(e),[4,this._requestQueue.send(t)];case 1:return n=s.sent(),[2,n.as(Pe).message]}}))}))},e.prototype.getScheduledMessage=function(e){return b(this,void 0,void 0,(function(){var t,n;return A(this,(function(s){switch(s.label){case 0:return t=new ze(e),[4,this._requestQueue.send(t)];case 1:return n=s.sent(),[2,n.as(Qe).message]}}))}))},e.prototype.getMessagesByMessageId=function(e,t,n,s,a){return void 0===a&&(a=j.REQUEST_MESSAGE),b(this,void 0,void 0,(function(){var i,l,u;return A(this,(function(o){switch(o.label){case 0:return i=new Oe(r(r({channelType:t,channelUrl:e,token:String(n)},qe),s)),[4,this._requestQueue.send(i)];case 1:return l=o.sent(),u=l.as(ke).messages,this._dispatcher.dispatch(new H({messages:u,source:a})),[2,u]}}))}))},e.prototype.getMessagesByTimestamp=function(e,t,n,s,a){return void 0===a&&(a=j.REQUEST_MESSAGE),b(this,void 0,void 0,(function(){var i,l,u;return A(this,(function(o){switch(o.label){case 0:return i=new Oe(r(r({channelType:t,channelUrl:e,timestamp:n},qe),s)),[4,this._requestQueue.send(i)];case 1:return l=o.sent(),u=l.as(ke).messages,this._dispatcher.dispatch(new H({messages:u,source:a})),[2,u]}}))}))},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,s,a,i){return void 0===a&&(a=j.REQUEST_MESSAGE),b(this,void 0,void 0,(function(){var l,u,o,d;return A(this,(function(c){switch(c.label){case 0:return l=new Oe(r(r(r({channelType:t,channelUrl:e,timestamp:n},qe),s),{checkingContinuousMessages:i})),[4,this._requestQueue.send(l)];case 1:return u=c.sent(),o=u.payload,d=u.as(ke).messages,this._dispatcher.dispatch(new H({messages:d,source:a})),[2,{messages:d,isContinuousMessages:o}]}}))}))},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,s){return void 0===s&&(s=j.REQUEST_THREADED_MESSAGE),b(this,void 0,void 0,(function(){var a,i,l,u;return A(this,(function(o){switch(o.label){case 0:return a=new Oe(r(r(r({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},ye),n),{replyType:Q.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(a)];case 1:return i=o.sent(),l=i.as(ke).messages,(u=l.slice(1)).forEach((function(t){t.parentMessage=e})),this._dispatcher.dispatch(new H({messages:u,source:s})),[2,{parentMessage:l[0],threadedMessages:u}]}}))}))},e.prototype.getMessageChangelogs=function(e,t,n,a,i){return void 0===i&&(i=j.REQUEST_MESSAGE_CHANGELOGS),b(this,void 0,void 0,(function(){var l,u,o,d,c,h,p,m;return A(this,(function(g){switch(g.label){case 0:return l=new Le(s(r(r({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},Ce),a))),[4,this._requestQueue.send(l)];case 1:return u=g.sent(),o=u.as(xe),d=o.updatedMessages,c=o.deletedMessagesInfo,h=o.hasMore,p=o.nextToken,m=c.map((function(e){return e.messageId})),d.length>0&&this._dispatcher.dispatch(new H({messages:d,source:i})),m.length>0&&this._dispatcher.dispatch(new W({messageIds:m,source:i})),[2,{updatedMessages:d,deletedMessageIds:m,hasMore:h,token:p}]}}))}))},e}(),je=function(){function e(){this._onPending=K,this._onFailed=K,this._onSucceeded=K}return e.prototype._trigger=function(e,t){switch(t.sendingStatus){case T.PENDING:0===t.errorCode&&this._onPending(t);break;case T.FAILED:case T.CANCELED:this._onFailed(e,t.scheduledInfo?null:t);break;case T.SCHEDULED:case T.SUCCEEDED:this._onSucceeded(t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this},e}(),He=function(t){function n(e,n){var s=t.call(this,e)||this;s.threadInfo=null,s.targetMessageId=0,s.channelUrl=null,s.channelType=null;var a=n.thread_info,i=n.parent_message_id,r=n.channel_url,l=n.channel_type;return a&&d("object",a)&&d("number",i)&&d("string",r)&&d("string",l)&&(s.threadInfo=new te(e,a),s.targetMessageId=i,s.channelUrl=r,s.channelType=l),s}return e(n,t),n}(u),We={channelUrl:null,channelType:null,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},Ke=function(n){function s(e){var s=e.channelCustomType,a=e.keyword,i=e.limit,r=e.reverse,l=e.exactMatch,u=e.channelUrl,o=e.order,d=e.messageTimestampFrom,c=e.messageTimestampTo,h=e.advancedQuery,p=e.targetFields,m=e.nextToken,g=n.call(this)||this;return g.method=t.GET,g.path="".concat(V,"/messages"),g.params={custom_type:s,query:a,limit:i,reverse:r,exact_match:l,channel_url:u,message_ts_from:d,message_ts_to:c,sort_field:o,advanced_query:h,target_fields:p,after:m},g}return e(s,n),s}(a),Ve=function(t){function n(e,n){var s=t.call(this,e,n)||this;return s.messages=n.results.map((function(t){return Me(e,t)})),s.hasNext=n.has_next,s.nextToken=n.end_cursor,s.totalCount=n.total_count,s}return e(n,t),n}(i);!function(e){e.SCORE="score",e.TIMESTAMP="ts"}(we||(we={}));var Xe=function(t){function n(e,n){var s,a,i,r,l,u,o,d,c,h=this;return(h=t.call(this,e,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=we.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(s=n.reverse)&&void 0!==s&&s,h.exactMatch=null!==(a=n.exactMatch)&&void 0!==a&&a,h.channelUrl=null!==(i=n.channelUrl)&&void 0!==i?i:"",h.channelCustomType=null!==(r=n.channelCustomType)&&void 0!==r?r:"",h.messageTimestampFrom=null!==(l=n.messageTimestampFrom)&&void 0!==l?l:null,h.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,h.order=null!==(o=n.order)&&void 0!==o?o:we.SCORE,h.advancedQuery=null!==(d=n.advancedQuery)&&void 0!==d&&d,h.targetFields=null!==(c=n.targetFields)&&void 0!==c?c:null,h}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&d("string",this.keyword)&&this.keyword.length>0&&d("boolean",this.reverse)&&d("boolean",this.exactMatch)&&d("string",this.channelUrl)&&d("string",this.channelCustomType)&&(d("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&(d("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&c(we,this.order)&&d("boolean",this.advancedQuery)&&o("string",this.targetFields,!0)},n.prototype.next=function(){return b(this,void 0,void 0,(function(){var e,t,n,s,a,i,l,u;return A(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=D.of(this._iid).requestQueue,t=new Ke(r(r({},this),{nextToken:this._nextToken?this._nextToken:null})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),s=n.as(Ve),a=s.messages,i=s.hasNext,l=s.nextToken,u=s.totalCount,this._nextToken=l,this._hasNext=i,this._isLoading=!1,this.totalCount=u,[2,a];case 2:return[2,[]];case 3:throw U.queryInProgress;case 4:return[3,6];case 5:throw U.invalidParameters;case 6:return[2]}}))}))},n}(X),Ye=function(t){function n(e,n,s,a){var i,r,l,u,o,d,c,h,p,m,g=this;return(g=t.call(this,e,n,s,a)||this).reverse=!1,g.messageTypeFilter=S.ALL,g.customTypesFilter=null,g.senderUserIdsFilter=null,g.replyType=Q.NONE,g.includeMetaArray=!1,g.includeReactions=!1,g.includeParentMessageInfo=!1,g.includeThreadInfo=!1,g.showSubchannelMessagesOnly=!1,g._edge=Number.MAX_SAFE_INTEGER,g.reverse=null!==(i=a.reverse)&&void 0!==i&&i,g.messageTypeFilter=null!==(r=a.messageTypeFilter)&&void 0!==r?r:S.ALL,g.customTypesFilter=null!==(l=a.customTypesFilter)&&void 0!==l?l:null,g.senderUserIdsFilter=null!==(u=a.senderUserIdsFilter)&&void 0!==u?u:null,g.replyType=null!==(o=a.replyType)&&void 0!==o?o:Q.NONE,g.includeMetaArray=null!==(d=a.includeMetaArray)&&void 0!==d&&d,g.includeReactions=null!==(c=a.includeReactions)&&void 0!==c&&c,g.includeParentMessageInfo=null!==(h=a.includeParentMessageInfo)&&void 0!==h&&h,g.includeThreadInfo=null!==(p=a.includeThreadInfo)&&void 0!==p&&p,g.showSubchannelMessagesOnly=null!==(m=a.showSubchannelMessagesOnly)&&void 0!==m&&m,g}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&d("boolean",this.reverse)&&c(S,this.messageTypeFilter)&&c(Q,this.replyType)&&o("string",this.customTypesFilter,!0)&&o("string",this.senderUserIdsFilter,!0)&&d("boolean",this.includeMetaArray)&&d("boolean",this.includeReactions)&&d("boolean",this.includeParentMessageInfo)&&d("boolean",this.includeThreadInfo)&&d("boolean",this.showSubchannelMessagesOnly)},n.prototype.load=function(){return b(this,void 0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Be.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,{prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly})]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,h([Number.MAX_SAFE_INTEGER],p(e.map((function(e){return e.createdAt}))),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw U.queryInProgress;case 4:return[3,6];case 5:throw U.invalidParameters;case 6:return[2]}}))}))},n}(Y),Ze={channelUrl:null,scheduledMessageId:0},$e=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="message",e}return e(n,t),n.prototype.init=function(e,n){var s=n.sdkState,a=n.dispatcher,i=n.sessionManager,r=n.requestQueue,l=n.logger,u=n.onlineDetector,o=n.cacheContext;t.prototype.init.call(this,e,{sdkState:s,dispatcher:a,sessionManager:i,requestQueue:r,logger:l,onlineDetector:u,cacheContext:o}),this._manager=new Be(e,{sdkState:s,dispatcher:a,requestQueue:r,onlineDetector:u,cacheContext:o})},n.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},n.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},n.prototype.getMessage=function(e){return b(this,void 0,void 0,(function(){var t;return A(this,(function(n){return t=r(r({},We),e),E(function(e){return d("string",e.channelUrl)&&d("string",e.channelType)&&c(_,e.channelType)&&d("number",e.messageId)&&d("boolean",e.includeMetaArray)&&d("boolean",e.includeParentMessageInfo)&&d("boolean",e.includeThreadInfo)}(t)).throw(U.invalidParameters),[2,this._manager.getMessage(t)]}))}))},n.prototype.getScheduledMessage=function(e){return b(this,void 0,void 0,(function(){var t;return A(this,(function(n){return t=r(r({},Ze),e),E(function(e){return d("string",e.channelUrl)&&d("number",e.scheduledMessageId)}(t)).throw(U.invalidParameters),[2,this._manager.getScheduledMessage(t)]}))}))},n}(Z);export{oe as A,he as B,Se as F,se as I,$e as M,le as O,ve as P,ae as R,me as S,ge as T,Ie as U,Xe as a,Be as b,re as c,Ye as d,pe as e,je as f,qe as g,Ce as h,Ne as i,ne as j,Ee as k,Te as l,ee as m,J as n,_e as o,Me as p,He as q,we as r,ue as s,ie as t,$ as u,Fe as v,te as w};
